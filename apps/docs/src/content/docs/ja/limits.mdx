---
title: 制限
---

Daytona では、すべての組織に対して公平な利用と安定性を確保するため、リソースおよびリクエストに制限を設けています。

## リソース制限 \{#resource-limits\}

リソースは起動中のすべてのサンドボックス間で共有されるため、一度に実行できるサンドボックスの数は、それぞれの使用状況に左右されます。
組織では、次の構成要素から成るコンピュートプールにアクセスできます：

* **vCPU** — 利用可能な CPU コアの合計数
* **Memory** — 利用可能な RAM の合計量
* **Storage** — 利用可能なディスク容量の合計

デフォルト値および利用設定の方法については、[Sandbox Resources](/docs/ja/sandbox-management/#sandbox-resources) を参照してください。現在の使用状況と制限は [Dashboard](https://app.daytona.io/dashboard/limits) で確認できます。

### ティアとリソース上限の引き上げ \{#tiers-resource-limit-increases\}

組織は、認証状況に基づいて自動的にティアに割り当てられます。\
以下の条件を満たすことで、より高い上限を利用できるようになります。

| ティア | リソース (vCPU / RAM / Storage) | アクセス要件                                                                                                             |
| ------ | -------------------------------- | ----------------------------------------------------------------------------------------------------------------------- |
| Tier 1 | 10 / 10GiB / 30GiB               | メールアドレス認証済み                                                                                                  |
| Tier 2 | 100 / 200GiB / 300GiB            | クレジットカード連携、$25 のチャージ、[GitHub 連携済み](/docs/ja/linked-accounts#how-to-link-an-account)。 |
| Tier 3 | 250 / 500GiB / 2000GiB           | ビジネスメールアドレス認証済み、電話番号認証済み、$500 のチャージ。                                                     |
| Tier 4 | 500 / 1000GiB / 5000GiB          | 30 日ごとに $2000 をチャージ。                                                                                          |
| Custom | カスタム上限                     | [support@daytona.io](mailto:support@daytona.io) までお問い合わせください                                                 |

上位ティアの条件を満たしたら、[Dashboard](https://app.daytona.io/dashboard/limits) の「Upgrade」ボタンをクリックしてアップグレードしてください。

### 利用量を動的に管理する \{#manage-usage-dynamically\}

サンドボックスの[状態を変更する](/docs/sandbox-management#sandbox-lifecycle)ことで、リソースの利用状況を管理できます。以下の表は、それぞれの状態がリソース利用にどのように影響するかをまとめたものです。

| State      | vCPU    | Memory  | Storage | Notes                                                      |
|------------|---------|---------|---------|------------------------------------------------------------|
| Running    |   ✅    |   ✅     |  ✅     | すべてのリソース制限に対して消費としてカウントされる       |
| Stopped    |   ❌    |   ❌     |  ✅     | CPU とメモリは解放されるが、ストレージは引き続き使用される |
| Archived   |   ❌    |   ❌     |  ❌     | データはコールドストレージに移動され、クォータへの影響はない |
| Deleted    |   ❌    |   ❌     |  ❌     | すべてのリソースが解放される                               |

詳細については、[Sandbox Management](/docs/ja/sandbox-management/) を参照してください。

***

## API リクエストのレート制限 \{#api-request-rate-limits\}

リクエストのレート制限は、利用中のプラン、認証状態、および実行する操作の種類に応じて適用されます。

### ティアとレート制限の引き上げ \{#tiers-rate-limit-increases\}

レート制限は、特定の時間枠内に実行できる API リクエスト数を制御します。これらの制限を理解しておくことで、レート制限を適切に処理し、サービス中断を回避できる堅牢なアプリケーションを構築できます。

| ティア | 一般リクエスト（1 分あたり） | サンドボックス作成（1 分あたり） | サンドボックスライフサイクル操作（1 分あたり） |
|--------|------------------------------|-----------------------------------|--------------------------------------------------|
| ティア 1 | 10,000                       | 300                               | 10,000                                           |
| ティア 2 | 20,000                       | 400                               | 20,000                                           |
| ティア 3 | 40,000                       | 500                               | 40,000                                           |
| ティア 4 | 50,000                       | 600                               | 50,000                                           |
| カスタム | カスタム制限                  | カスタム制限                      | カスタム制限                                     |

### 一般的な API リクエスト \{#general-api-requests\}

これは、サンドボックスの作成やライフサイクル操作に該当しない認証済み API リクエストに適用される一般的なレート制限です。これには次のものが含まれます：

* サンドボックスの一覧取得
* サンドボックス詳細の取得
* サンドボックスのリージョン情報の取得
* スナップショットの一覧取得
* ボリュームの管理
* 監査ログの閲覧
* その他の読み取り／管理操作

一般的な認証済みリクエストに対するレート制限は、組織ごとに管理されます。

***

### サンドボックスの作成 \{#sandbox-creation\}

このレート制限は、スナップショットからの作成、宣言的ビルド、`daytona.create()`（SDK）にその他のパラメータを指定した場合や `/api/sandbox`（API）への POST リクエストなど、すべてのサンドボックス作成方法に適用されます。

この独立した上限により、リソースの枯渇を防ぎつつ、既存のサンドボックスに対するライフサイクル操作は制限なく実行できます。

:::note
お使いのユースケースで、より高い頻度でサンドボックスを作成する必要がある場合は、カスタムレート制限についてご相談いただくために [support@daytona.io](mailto:support@daytona.io) までご連絡ください。
:::

***

### サンドボックスのライフサイクル操作 \{#sandbox-lifecycle-operations\}

このレート制限は、既存のサンドボックスに対するライフサイクルおよび状態管理操作に適用されます：

* サンドボックスの**起動** (`POST /api/sandbox/:id/start`)
* サンドボックスの**停止** (`POST /api/sandbox/:id/stop`)
* サンドボックスの**削除** (`DELETE /api/sandbox/:id`)
* サンドボックスの**アーカイブ** (`POST /api/sandbox/:id/archive`)

およびそれに対応するすべての SDK メソッド。

これらの操作は、開発ワークフロー中により頻繁に実行されることが多いため、より高い上限が設定されています。

***

### 制限に達した場合の挙動 \{#what-happens-when-you-hit-the-limit\}

レート制限を超過すると、それ以降のリクエストは失敗し、次の応答が返されます。

* **HTTP ステータス**: `429 Too Many Requests`
* **エラーレスポンス**: レート制限の詳細を含む JSON ボディ
* **Retry-After ヘッダー**: 再試行までに待機する必要がある時間（秒単位）

#### SDK の動作 \{#sdk-behavior\}

公式の Daytona SDK を使用している場合は、次のように動作します:

* **TypeScript SDK**: `RateLimitError` をスローします
* **Python SDK**: `RateLimitException` をスローします

#### エラーレスポンスの例 \{#example-error-response\}

```json
{
  "statusCode": 429,
  "message": "レート制限を超過しました",
  "error": "リクエスト数が多すぎます"
}
```

***

### レート制限ヘッダー \{#rate-limit-headers\}

Daytona は、API レスポンスヘッダーにレート制限情報を含めます：

| Header                  | Description                                                        |
|-------------------------|--------------------------------------------------------------------|
| `X-RateLimit-Limit`     | 時間枠内で許可される最大リクエスト数                              |
| `X-RateLimit-Remaining` | 現在の時間枠で残っているリクエスト数                              |
| `X-RateLimit-Reset`     | レート制限の時間枠がリセットされるまでの秒数                      |
| `Retry-After`           | 再試行する前に待機する秒数（制限を超過した場合にレスポンスに含まれます） |

### ベストプラクティス \{#best-practices\}

レート制限の範囲内で効率的に動作させるために、`429` エラーが発生した場合は、適切なリトライロジックで必ず丁寧に処理してください。レート制限エラーを受け取ったら、指数バックオフを実装し、API に過度な負荷をかけないようにリトライの間隔を徐々に伸ばして待機します（1s、2s、4s、8s など）。以下はその一例です。

```typescript
async function createSandboxWithRetry() {
  let retries = 0
  const maxRetries = 5

  while (retries < maxRetries) {
    try {
      return await daytona.create({ snapshot: 'my-snapshot' })
    } catch (error) {
      if (error.statusCode === 429 && retries < maxRetries - 1) {
        const delay = Math.pow(2, retries) * 1000 // 1秒、2秒、4秒、8秒、16秒
        await new Promise(resolve => setTimeout(resolve, delay))
        retries++
      } else {
        throw error
      }
    }
  }
}
```

**レート制限ヘッダー**（`X-RateLimit-Remaining`、`X-RateLimit-Reset`）を監視して、利用状況を把握し、上限に達する前に積極的なスロットリング制御を実装してください。

**頻繁に変化しない API レスポンスをキャッシュ**します。たとえば（比較的静的な）サンドボックス一覧、利用可能なリージョン、スナップショット情報などです。これにより不要な API 呼び出しが減り、レート制限の範囲内に余裕をもって収まるのに役立ちます。

**サンドボックス作成をバッチ化・最適化**し、逐次的にではなく（レート制限の範囲内で）複数のサンドボックスを並列に作成します。可能な場合は、タスクごとに新規作成するのではなく既存のサンドボックスを再利用することも検討してください。

**サンドボックスのライフサイクルを効率的に管理**して API 呼び出しを削減します。サンドボックスを削除・再作成する代わりにアーカイブしたり、削除ではなく未使用時に停止するようにし、[auto-stop intervals](/docs/ja/sandbox-management#auto-stop) を活用して、手動操作なしで稼働中のサンドボックスを自動管理してください。

**リクエストのキューイングを実装**して、レート制限を超えるバーストを防ぎ、状態変更の取得にはポーリングではなく [ウェブフック](/docs/ja/webhooks) を使用して不要な API 呼び出しを避けてください。アプリケーションログ内の `429` エラーに対するモニタリングとアラートを設定し、ユーザーに影響が出る前にレート制限の問題へ事前に対処できるようにします。

***

## さらに必要ですか？ \{#need-more\}

より高い、または特別な上限が必要な場合は、[support@daytona.io](mailto:support@daytona.io) までお問い合わせください。