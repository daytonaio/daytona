---
title: "AsyncDaytona"
hideTitleOnPage: true
---

## AsyncDaytona \{#asyncdaytona\}

```python
class AsyncDaytona()
```

Daytona API とやり取りするためのメインクラス。

このクラスは、Daytona のサンドボックスを作成・管理・操作するための非同期メソッドを提供します。
明示的な設定または環境変数を用いて初期化できます。

**属性**:

* `volume` *AsyncVolumeService* - ボリュームを管理するサービス。
* `snapshot` *AsyncSnapshotService* - スナップショットを管理するサービス。

**例**:

環境変数を使用する場合:

```python
async with AsyncDaytona() as daytona:  # Uses DAYTONA_API_KEY, DAYTONA_API_URL
    sandbox = await daytona.create()
```

明示的な設定を使用する場合:

```python
config = DaytonaConfig(
    api_key="your-api-key",
    api_url="https://your-api.com",
    target="us"
)
try:
    daytona = AsyncDaytona(config)
    sandbox = await daytona.create()
finally:
    await daytona.close()
```

#### AsyncDaytona.&#95;&#95;init&#95;&#95; \{#asyncdaytona&#95;&#95;init&#95;&#95;\}

```python
def __init__(config: Optional[DaytonaConfig] = None)
```

任意の設定で Daytona インスタンスを初期化します。

設定が指定されない場合は、次の環境変数から読み込みます:

* `DAYTONA_API_KEY`: 認証に必須の API キー
* `DAYTONA_API_URL`: 必須の API URL
* `DAYTONA_TARGET`: 任意のターゲット環境（既定値は &#39;us&#39;）

**引数**:

* `config` *Optional[DaytonaConfig]* - api&#95;key、api&#95;url、target を含むオブジェクト。

**例外**:

* `DaytonaError` - 設定または環境変数のいずれかで API キーが指定されていない場合

**例**:

```python
from daytona import Daytona, DaytonaConfig
# 環境変数を使用
daytona1 = AsyncDaytona()
await daytona1.close()
# 明示的な設定を使用
config = DaytonaConfig(
    api_key="your-api-key",
    api_url="https://your-api.com",
    target="us"
)
daytona2 = AsyncDaytona(config)
await daytona2.close()
```

#### AsyncDaytona.**aenter** \{#asyncdaytona&#95;&#95;aenter&#95;&#95;\}

```python
async def __aenter__()
```

非同期コンテキストマネージャーの開始処理。

#### AsyncDaytona.&#95;&#95;aexit&#95;&#95; \{#asyncdaytona&#95;&#95;aexit&#95;&#95;\}

```python
async def __aexit__(exc_type, exc_value, traceback)
```

非同期コンテキストマネージャの終了処理—適切にクリーンアップします。

#### AsyncDaytona.close \{#asyncdaytonaclose\}

```python
async def close()
```

HTTP セッションを閉じ、リソースをクリーンアップします。

このメソッドは、AsyncDaytona インスタンスの使用を終えたら呼び出し、
基盤となる HTTP セッションを正しく閉じてリソースリークを防ぐために必要です。

**例**:

```python
daytona = AsyncDaytona()
try:
    sandbox = await daytona.create()
    # ... サンドボックスを使用 ...
finally:
    await daytona.close()
```

あるいは、非同期コンテキストマネージャーとして使用するのが望ましいです:

```python
async with AsyncDaytona() as daytona:
    sandbox = await daytona.create()
    # ... サンドボックスを使用 ...
# 自動的にクローズされます
```

#### AsyncDaytona.create \{#asyncdaytonacreate\}

```python
@overload
async def create(params: Optional[CreateSandboxFromSnapshotParams] = None,
                 *,
                 timeout: Optional[float] = 60) -> AsyncSandbox
```

指定した、またはデフォルトのスナップショットからサンドボックスを作成します。言語、イメージ、環境変数、ボリュームなど、さまざまなパラメーターを指定できます。

**引数**:

* `params` *Optional[CreateSandboxFromSnapshotParams]* - サンドボックス作成用のパラメーター。未指定の場合は、
  デフォルトのDaytonaスナップショットとPython言語が使用されます。
* `timeout` *Optional[float]* - サンドボックス作成のタイムアウト（秒）。0はタイムアウトなしを意味します。
  デフォルトは60秒です。

**戻り値**:

* `Sandbox` - 作成されたサンドボックスのインスタンス。

**例外**:

* `DaytonaError` - timeout、auto&#95;stop&#95;interval、またはauto&#95;archive&#95;intervalが負の値の場合、
  またはサンドボックスの起動に失敗した／タイムアウトした場合

**例**:

デフォルトのPythonサンドボックスを作成:

```python
sandbox = await daytona.create()
```

カスタムサンドボックスを作成:

```python
params = CreateSandboxFromSnapshotParams(
    language="python",
    snapshot="my-snapshot-id",
    env_vars={"DEBUG": "true"},
    auto_stop_interval=0,
    auto_archive_interval=60,
    auto_delete_interval=120
)
sandbox = await daytona.create(params, timeout=40)
```

#### AsyncDaytona.create \{#asyncdaytonacreate\}

```python
@overload
async def create(
        params: Optional[CreateSandboxFromImageParams] = None,
        *,
        timeout: Optional[float] = 60,
        on_snapshot_create_logs: Callable[[str], None] = None) -> AsyncSandbox
```

レジストリで利用可能な指定のイメージ、または宣言的な Daytona イメージからサンドボックスを作成します。
リソース、言語、イメージ、環境変数、ボリュームなど、さまざまなパラメータを指定できます。Daytona は指定されたイメージからスナップショットを作成し、それを用いてサンドボックスを作成します。

**引数**:

* `params` *Optional[CreateSandboxFromImageParams]* - イメージからサンドボックスを作成するためのパラメータ。
* `timeout` *Optional[float]* - サンドボックス作成のタイムアウト（秒）。0 はタイムアウトなしを意味します。
  既定値は 60 秒です。
* `on_snapshot_create_logs` *Callable[[str], None]* - スナップショット作成時のログを処理するコールバック関数。

**戻り値**:

* `Sandbox` - 作成されたサンドボックスインスタンス。

**例外**:

* `DaytonaError` - timeout、auto&#95;stop&#95;interval、または auto&#95;archive&#95;interval が負の値の場合、
  あるいはサンドボックスの起動に失敗した、またはタイムアウトした場合。

**例**:

イメージからデフォルトの Python サンドボックスを作成:

```python
sandbox = await daytona.create(CreateSandboxFromImageParams(image="debian:12.9"))
```

宣言的なイメージ定義からカスタム サンドボックスを作成:

```python
declarative_image = (
    Image.base("alpine:3.18")
    .pipInstall(["numpy", "pandas"])
    .env({"MY_ENV_VAR": "My Environment Variable"})
)
params = CreateSandboxFromImageParams(
    language="python",
    image=declarative_image,
    env_vars={"DEBUG": "true"},
    resources=Resources(cpu=2, memory=4),
    auto_stop_interval=0,
    auto_archive_interval=60,
    auto_delete_interval=120
)
sandbox = await daytona.create(
    params,
    timeout=40,
    on_snapshot_create_logs=lambda chunk: print(chunk, end=""),
)
```

#### AsyncDaytona.delete \{#asyncdaytonadelete\}

```python
async def delete(sandbox: AsyncSandbox, timeout: Optional[float] = 60) -> None
```

サンドボックスを削除します。

**引数**:

* `sandbox` *Sandbox* - 削除するサンドボックスのインスタンス。
* `timeout` *Optional[float]* - サンドボックス削除のタイムアウト（秒）。0 はタイムアウトなしを意味します。
  デフォルトは 60 秒です。

**例外**:

* `DaytonaError` - サンドボックスの削除に失敗した場合、またはタイムアウトした場合

**例**:

```python
sandbox = await daytona.create()
# ... サンドボックスを使用 ...
await daytona.delete(sandbox)  # 完了時にクリーンアップ
```

#### AsyncDaytona.get \{#asyncdaytonaget\}

```python
@intercept_errors(message_prefix="サンドボックスの取得に失敗しました: ")
async def get(sandbox_id: str) -> AsyncSandbox
```

ID でサンドボックスを取得します。

**引数**:

* `sandbox_id` *str* - 取得するサンドボックスのID。

**戻り値**:

* `Sandbox` - サンドボックスのインスタンス。

**例外**:

* `DaytonaError` - `sandbox_id` が指定されていない場合。

**例**:

```python
sandbox = await daytona.get("my-sandbox-id")
print(sandbox.state)
```

#### AsyncDaytona.find&#95;one \{#asyncdaytonafind&#95;one\}

```python
@intercept_errors(message_prefix="Failed to find sandbox: ")
async def find_one(sandbox_id: Optional[str] = None,
                   labels: Optional[Dict[str, str]] = None) -> AsyncSandbox
```

ID またはラベルでサンドボックスを検索します。

**引数**:

* `sandbox_id` *Optional[str]* - 取得するサンドボックスの ID。
* `labels` *Optional[Dict[str, str]]* - サンドボックスをフィルタリングするためのラベル。

**戻り値**:

* `Sandbox` - ID またはラベルに一致する最初のサンドボックス。

**例外**:

* `DaytonaError` - サンドボックスが見つからない場合。

**例**:

```python
sandbox = await daytona.find_one(labels={"my-label": "my-value"})
print(f"Sandbox ID: {sandbox.id} State: {sandbox.state}")
```

#### AsyncDaytona.list \{#asyncdaytonalist\}

```python
@intercept_errors(message_prefix="サンドボックスの一覧取得に失敗しました: ")
async def list(labels: Optional[Dict[str, str]] = None,
               page: Optional[int] = None,
               limit: Optional[int] = None) -> AsyncPaginatedSandboxes
```

ラベルでフィルタしたサンドボックスのページネーション付き一覧を返します。

**引数**:

* `labels` *Optional[Dict[str, str]]* - サンドボックスを絞り込むためのラベル。
* `page` *Optional[int]* - ページ番号（1から開始）。
* `limit` *Optional[int]* - 1ページあたりの最大件数。

**戻り値**:

* `AsyncPaginatedSandboxes` - ラベルに一致するサンドボックスインスタンスのページネーション付き一覧。

**例**:

```python
result = await daytona.list(labels={"my-label": "my-value"}, page=2, limit=10)
for sandbox in result.items:
    print(f"{sandbox.id}: {sandbox.state}")
```

#### AsyncDaytona.start \{#asyncdaytonastart\}

```python
async def start(sandbox: AsyncSandbox, timeout: Optional[float] = 60) -> None
```

サンドボックスを起動し、準備が整うまで待機します。

**引数**:

* `sandbox` *Sandbox* - 起動するサンドボックス。
* `timeout` *Optional[float]* - サンドボックスの起動完了まで待機するタイムアウト（秒）。\
  0 はタイムアウトなしを意味します。デフォルトは 60 秒です。

**送出**:

* `DaytonaError` - タイムアウトが負の場合、サンドボックスの起動に失敗した場合、またはタイムアウトした場合

#### AsyncDaytona.stop \{#asyncdaytonastop\}

```python
async def stop(sandbox: AsyncSandbox, timeout: Optional[float] = 60) -> None
```

サンドボックスを停止し、停止完了まで待機します。

**引数**:

* `sandbox` *Sandbox* - 停止対象のサンドボックス
* `timeout` *Optional[float]* - サンドボックス停止のタイムアウト（秒）。0 はタイムアウトなしを意味します。デフォルトは 60 秒。

**例外**:

* `DaytonaError` - タイムアウトが負の値の場合、またはサンドボックスの停止に失敗・タイムアウトした場合

## CodeLanguage \{#codelanguage\}

```python
@dataclass
class CodeLanguage(Enum)
```

Daytona がサポートするプログラミング言語

**列挙体メンバー**:

* `PYTHON` (&quot;python&quot;)
  * `TYPESCRIPT` (&quot;typescript&quot;)
  * `JAVASCRIPT` (&quot;javascript&quot;)

## DaytonaConfig \{#daytonaconfig\}

```python
class DaytonaConfig(BaseModel)
```

Daytona クライアントを初期化するための設定オプション。

**属性**:

* `api_key` *Optional[str]* - Daytona API で認証するための APIキー。未設定の場合は、環境変数 `DAYTONA_API_KEY` で指定するか、代わりに JWT トークンを指定する必要があります。
* `jwt_token` *Optional[str]* - Daytona API で認証するための JWT トークン。未設定の場合は、環境変数 `DAYTONA_JWT_TOKEN` で指定するか、代わりに APIキーを指定する必要があります。
* `organization_id` *Optional[str]* - JWT ベース認証で使用する組織 ID。JWT トークンが指定されている場合は必須で、ここで指定するか環境変数 `DAYTONA_ORGANIZATION_ID` に設定する必要があります。
* `api_url` *Optional[str]* - Daytona API の URL。ここで未設定の場合、または環境変数 `DAYTONA_API_URL` が未設定の場合は `'https://app.daytona.io/api'` がデフォルトになります。
* `server_url` *Optional[str]* - 非推奨。代わりに `api_url` を使用してください。このプロパティは将来のバージョンで削除されます。
* `target` *Optional[str]* - サンドボックスのターゲットとなるランナーのリージョン。ここで未設定の場合、または環境変数 `DAYTONA_TARGET` が未設定の場合は `'us'` がデフォルトになります。

**例**:

```python
config = DaytonaConfig(api_key="your-api-key")
```

```python
config = DaytonaConfig(jwt_token="your-jwt-token", organization_id="your-organization-id")
```

## CreateSandboxBaseParams \{#createsandboxbaseparams\}

```python
class CreateSandboxBaseParams(BaseModel)
```

新しいサンドボックスを作成するための基本パラメータ。

**属性**:

* `name` *Optional[str]* - サンドボックス名。
* `language` *Optional[CodeLanguage]* - サンドボックスのプログラミング言語。既定は &quot;python&quot;。
* `os_user` *Optional[str]* - サンドボックスの OS ユーザー。
* `env_vars` *Optional[Dict[str, str]]* - サンドボックスで設定する環境変数。
* `labels` *Optional[Dict[str, str]]* - サンドボックスのカスタムラベル。
* `public` *Optional[bool]* - サンドボックスを公開にするかどうか。
* `timeout` *Optional[float]* - サンドボックスの作成と起動のタイムアウト（秒）。
* `auto_stop_interval` *Optional[int]* - この時間内にサンドボックスのイベントが発生しない場合に
  自動停止するまでの間隔（分）。既定は 15 分。
  0 は自動停止なしを意味します。
* `auto_archive_interval` *Optional[int]* - 継続して停止中のサンドボックスが
  自動的にアーカイブされるまでの間隔（分）。既定は 7 日。
  0 は最大の間隔が使用されることを意味します。
* `auto_delete_interval` *Optional[int]* - 継続して停止中のサンドボックスが
  自動的に削除されるまでの間隔（分）。既定では自動削除は無効です。
  負の値は無効、0 は停止と同時に即時削除を意味します。
* `volumes` *Optional[List[VolumeMount]]* - サンドボックスにアタッチするボリュームのマウント一覧。
* `network_block_all` *Optional[bool]* - サンドボックスのすべてのネットワークアクセスをブロックするかどうか。
* `network_allow_list` *Optional[str]* - サンドボックスで許可する CIDR ネットワークアドレスのカンマ区切りリスト。
* `ephemeral` *Optional[bool]* - サンドボックスを使い捨て（エフェメラル）にするかどうか。
  True の場合、auto&#95;delete&#95;interval は 0 に設定されます。

## CreateSandboxFromImageParams \{#createsandboxfromimageparams\}

```python
class CreateSandboxFromImageParams(CreateSandboxBaseParams)
```

イメージから新しいサンドボックスを作成するためのパラメータ。

**属性**:

* `image` *Union[str, Image]* - サンドボックスで使用するカスタム Docker イメージ。Image オブジェクトが指定された場合、
  イメージは動的にビルドされます。
* `resources` *Optional[Resources]* - サンドボックスのリソース設定。指定しない場合、サンドボックスは
  既定のリソースを使用します。

## CreateSandboxFromSnapshotParams \{#createsandboxfromsnapshotparams\}

```python
class CreateSandboxFromSnapshotParams(CreateSandboxBaseParams)
```

スナップショットから新しいサンドボックスを作成するためのパラメータ。

**属性**:

* `snapshot` *Optional[str]* - サンドボックスに使用するスナップショット名。