---
title: "AsyncDaytona"
hideTitleOnPage: true
---

## AsyncDaytona \{#asyncdaytona\}

```python
class AsyncDaytona()
```

Daytona API とやり取りするためのメインクラス。

このクラスは、Daytona のサンドボックスを作成・管理・操作するための非同期メソッドを提供します。
明示的な設定または環境変数を用いて初期化できます。

**属性**:

* `volume` *AsyncVolumeService* - ボリュームを管理するサービス。
* `snapshot` *AsyncSnapshotService* - スナップショットを管理するサービス。

**例**:

環境変数を使用する場合:

```python
async with AsyncDaytona() as daytona:  # DAYTONA_API_KEY、DAYTONA_API_URL を使用
    sandbox = await daytona.create()
```

明示的な設定を使用する場合:

```python
config = DaytonaConfig(
    api_key="your-api-key",
    api_url="https://your-api.com",
    target="us"
)
try:
    daytona = AsyncDaytona(config)
    sandbox = await daytona.create()
finally:
    await daytona.close()
```

OpenTelemetry トレースを使用する場合:

```python
config = DaytonaConfig(
    api_key="your-api-key",
    experimental={"otelEnabled": True}
)
async with AsyncDaytona(config) as daytona:
    sandbox = await daytona.create()
    # All SDK operations will be traced
# OpenTelemetry トレースはクローズ時にフラッシュされます
```

#### AsyncDaytona.**init** \{#asyncdaytona__init__\}

```python
def __init__(config: DaytonaConfig | None = None)
```

オプションの設定で Daytona インスタンスを初期化します。

設定が指定されていない場合は、環境変数から読み込みます:

* `DAYTONA_API_KEY`: 認証に必須の API キー
* `DAYTONA_API_URL`: 必須の API URL
* `DAYTONA_TARGET`: 任意のターゲット環境（未指定の場合、組織のデフォルトリージョンが使用されます）

**引数**:

* `config` *DaytonaConfig | None* - api&#95;key、api&#95;url、target を含むオブジェクト。

**例外**:

* `DaytonaError` - 設定または環境変数で API キーが指定されていない場合

**例**:

```python
from daytona import Daytona, DaytonaConfig
# 環境変数を使用
daytona1 = AsyncDaytona()
await daytona1.close()
# 明示的な設定を使用
config = DaytonaConfig(
    api_key="your-api-key",
    api_url="https://your-api.com",
    target="us"
)
daytona2 = AsyncDaytona(config)
await daytona2.close()
```

#### AsyncDaytona.**aenter** \{#asyncdaytona__aenter__\}

```python
async def __aenter__()
```

非同期コンテキストマネージャーの開始処理。

#### AsyncDaytona.**aexit** \{#asyncdaytona__aexit__\}

```python
async def __aexit__(exc_type: type[BaseException] | None = None,
                    exc_value: BaseException | None = None,
                    traceback: TracebackType | None = None)
```

非同期コンテキストマネージャの終了処理—適切にクリーンアップします。

#### AsyncDaytona.close \{#asyncdaytonaclose\}

```python
async def close()
```

HTTP セッションを閉じ、リソースをクリーンアップします。

AsyncDaytona インスタンスの使用が完了したら、このメソッドを呼び出してください。基盤となる HTTP セッションを適切に閉じ、リソースのリークを防ぎます。

**例**:

```python
daytona = AsyncDaytona()
try:
    sandbox = await daytona.create()
    # ... サンドボックスを使用 ...
finally:
    await daytona.close()
```

あるいは、より良い方法として非同期コンテキストマネージャーとして使用します：

```python
async with AsyncDaytona() as daytona:
    sandbox = await daytona.create()
    # ... サンドボックスを使用 ...
# 自動的にクローズされます
```

#### AsyncDaytona.create \{#asyncdaytonacreate\}

```python
@overload
async def create(params: CreateSandboxFromSnapshotParams | None = None,
                 *,
                 timeout: float = 60) -> AsyncSandbox
```

指定した、またはデフォルトのスナップショットからサンドボックスを作成します。言語、イメージ、環境変数、ボリュームなど、さまざまなパラメーターを指定できます。

**引数**:

* `params` *CreateSandboxFromSnapshotParams | None* - サンドボックス作成用のパラメーター。未指定の場合は、
  デフォルトのDaytonaスナップショットとPython言語が使用されます。
* `timeout` *float* - サンドボックス作成のタイムアウト（秒）。0はタイムアウトなしを意味します。
  デフォルトは60秒です。

**戻り値**:

* `Sandbox` - 作成されたサンドボックスのインスタンス。

**例外**:

* `DaytonaError` - timeout、auto&#95;stop&#95;interval、またはauto&#95;archive&#95;intervalが負の値の場合、
  またはサンドボックスの起動に失敗した／タイムアウトした場合

**例**:

デフォルトのPythonサンドボックスを作成:

```python
sandbox = await daytona.create()
```

カスタムサンドボックスを作成:

```python
params = CreateSandboxFromSnapshotParams(
    language="python",
    snapshot="my-snapshot-id",
    env_vars={"DEBUG": "true"},
    auto_stop_interval=0,
    auto_archive_interval=60,
    auto_delete_interval=120
)
sandbox = await daytona.create(params, timeout=40)
```

#### AsyncDaytona.create \{#asyncdaytonacreate\}

```python
@overload
async def create(
    params: CreateSandboxFromImageParams | None = None,
    *,
    timeout: float = 60,
    on_snapshot_create_logs: Callable[[str], None] | None = None
) -> AsyncSandbox
```

レジストリで利用可能な指定のイメージ、または宣言的な Daytona イメージからサンドボックスを作成します。
リソース、言語、イメージ、環境変数、ボリュームなど、さまざまなパラメータを指定できます。Daytona は指定されたイメージからスナップショットを作成し、それを用いてサンドボックスを作成します。

**引数**:

* `params` *CreateSandboxFromImageParams | None* - イメージからサンドボックスを作成するためのパラメータ。
* `timeout` *float* - サンドボックス作成のタイムアウト（秒）。0 はタイムアウトなしを意味します。
  既定値は 60 秒です。
* `on_snapshot_create_logs` *Callable[[str], None] | None* - スナップショット作成時のログを処理するコールバック関数。

**戻り値**:

* `Sandbox` - 作成されたサンドボックスインスタンス。

**例外**:

* `DaytonaError` - timeout、auto&#95;stop&#95;interval、または auto&#95;archive&#95;interval が負の値の場合、
  あるいはサンドボックスの起動に失敗した、またはタイムアウトした場合。

**例**:

イメージからデフォルトの Python サンドボックスを作成:

```python
sandbox = await daytona.create(CreateSandboxFromImageParams(image="debian:12.9"))
```

宣言的なイメージ定義からカスタム サンドボックスを作成:

```python
declarative_image = (
    Image.base("alpine:3.18")
    .pipInstall(["numpy", "pandas"])
    .env({"MY_ENV_VAR": "My Environment Variable"})
)
params = CreateSandboxFromImageParams(
    language="python",
    image=declarative_image,
    env_vars={"DEBUG": "true"},
    resources=Resources(cpu=2, memory=4),
    auto_stop_interval=0,
    auto_archive_interval=60,
    auto_delete_interval=120
)
sandbox = await daytona.create(
    params,
    timeout=40,
    on_snapshot_create_logs=lambda chunk: print(chunk, end=""),
)
```

#### AsyncDaytona.delete \{#asyncdaytonadelete\}

```python
@with_instrumentation()
@with_instrumentation()
async def delete(sandbox: AsyncSandbox, timeout: float = 60) -> None
```

サンドボックスを削除します。

**引数**:

* `sandbox` *Sandbox* - 削除するサンドボックスのインスタンス。
* `timeout` *float* - サンドボックス削除のタイムアウト（秒）。0 はタイムアウトなしを意味します。
  デフォルトは 60 秒です。

**例外**:

* `DaytonaError` - サンドボックスの削除に失敗した場合、またはタイムアウトした場合

**例**:

```python
sandbox = await daytona.create()
# ... サンドボックスを使用 ...
await daytona.delete(sandbox)  # 完了時にクリーンアップ
```

#### AsyncDaytona.get \{#asyncdaytonaget\}

```python
@intercept_errors(message_prefix="サンドボックスの取得に失敗しました: ")
@with_instrumentation()
async def get(sandbox_id_or_name: str) -> AsyncSandbox
```

ID または名前でサンドボックスを取得します。

**引数**:

* `sandbox_id_or_name` *str* - 取得するサンドボックスのIDまたは名前。

**戻り値**:

* `Sandbox` - サンドボックスのインスタンス。

**例外**:

* `DaytonaError` - `sandbox_id_or_name` が指定されていない場合。

**例**:

```python
sandbox = await daytona.get("my-sandbox-id-or-name")
print(sandbox.state)
```

#### AsyncDaytona.find_one \{#asyncdaytonafind_one\}

```python
@intercept_errors(message_prefix="サンドボックスの検索に失敗しました: ")
@with_instrumentation()
async def find_one(sandbox_id_or_name: str | None = None,
                   labels: dict[str, str] | None = None) -> AsyncSandbox
```

ID、名前、またはラベルでサンドボックスを検索します。

**引数**:

* `sandbox_id_or_name` *str | None* - 取得するサンドボックスのIDまたは名前。
* `labels` *dict[str, str] | None* - サンドボックスを絞り込むためのラベル。

**戻り値**:

* `Sandbox` - ID、名前、またはラベルに一致する最初のサンドボックス。

**送出**:

* `DaytonaError` - サンドボックスが見つからない場合。

**例**:

```python
sandbox = await daytona.find_one(labels={"my-label": "my-value"})
print(f"サンドボックスID: {sandbox.id} 状態: {sandbox.state}")
```

#### AsyncDaytona.list \{#asyncdaytonalist\}

```python
@intercept_errors(message_prefix="サンドボックスの一覧取得に失敗しました: ")
@with_instrumentation()
async def list(labels: dict[str, str] | None = None,
               page: int | None = None,
               limit: int | None = None) -> AsyncPaginatedSandboxes
```

ラベルでフィルタしたサンドボックスのページネーション付き一覧を返します。

**引数**:

* `labels` *dict[str, str] | None* - サンドボックスを絞り込むためのラベル。
* `page` *int | None* - ページ番号（1から開始）。
* `limit` *int | None* - 1ページあたりの最大件数。

**戻り値**:

* `AsyncPaginatedSandboxes` - ラベルに一致するサンドボックスインスタンスのページネーション付き一覧。

**例**:

```python
result = await daytona.list(labels={"my-label": "my-value"}, page=2, limit=10)
for sandbox in result.items:
    print(f"{sandbox.id}: {sandbox.state}")
```

#### AsyncDaytona.start \{#asyncdaytonastart\}

```python
@with_instrumentation()
async def start(sandbox: AsyncSandbox, timeout: float = 60) -> None
```

サンドボックスを起動し、準備が整うまで待機します。

**引数**:

* `sandbox` *Sandbox* - 起動するサンドボックス。
* `timeout` *float* - サンドボックスの起動完了まで待機するタイムアウト（秒）。
  0 はタイムアウトなしを意味します。デフォルトは 60 秒です。

**送出**:

* `DaytonaError` - タイムアウトが負の場合、サンドボックスの起動に失敗した場合、またはタイムアウトした場合

#### AsyncDaytona.stop \{#asyncdaytonastop\}

```python
@with_instrumentation()
async def stop(sandbox: AsyncSandbox, timeout: float = 60) -> None
```

サンドボックスを停止し、停止完了まで待機します。

**引数**:

* `sandbox` *Sandbox* - 停止対象のサンドボックス
* `timeout` *float* - サンドボックス停止のタイムアウト（秒）。0 はタイムアウトなしを意味します。デフォルトは 60 秒。

**例外**:

* `DaytonaError` - タイムアウトが負の値の場合、またはサンドボックスの停止に失敗・タイムアウトした場合

## CodeLanguage \{#codelanguage\}

```python
class CodeLanguage(str, Enum)
```

Daytona がサポートするプログラミング言語

**列挙体メンバー**:

* `PYTHON` (&quot;python&quot;)
  * `TYPESCRIPT` (&quot;typescript&quot;)
  * `JAVASCRIPT` (&quot;javascript&quot;)

## DaytonaConfig \{#daytonaconfig\}

```python
class DaytonaConfig(BaseModel)
```

Daytona クライアントを初期化するための設定オプション。

**属性**:

* `api_key` *str | None* - Daytona API との認証に使用する API キー。設定されていない場合は、
  環境変数 `DAYTONA_API_KEY` で指定するか、代わりに JWT トークンを指定する必要があります。
* `jwt_token` *str | None* - Daytona API との認証に使用する JWT トークン。設定されていない場合は、
  環境変数 `DAYTONA_JWT_TOKEN` で指定するか、代わりに API キーを指定する必要があります。
* `organization_id` *str | None* - JWT ベースの認証で使用される組織 ID。JWT トークンが指定されている場合は必須であり、
  ここで指定するか、環境変数 `DAYTONA_ORGANIZATION_ID` に設定しておく必要があります。
* `api_url` *str | None* - Daytona API の URL。ここで設定されていない場合や、環境変数 `DAYTONA_API_URL` に設定されていない場合は、
  デフォルトで `'https://app.daytona.io/api'` が使用されます。
* `server_url` *str | None* - 非推奨。代わりに `api_url` を使用してください。このプロパティは将来のバージョンで削除されます。
* `target` *str | None* - サンドボックスのターゲットとなるランナーのロケーション。ここで設定されていない場合や、
  環境変数 `DAYTONA_TARGET` に設定されていない場合は、組織のデフォルトリージョンが使用されます。
* `_experimental` *dict[str, any] | None* - 実験的機能向けの設定。

**例**:

```python
config = DaytonaConfig(api_key="your-api-key")
```

```python
config = DaytonaConfig(jwt_token="your-jwt-token", organization_id="your-organization-id")
```

## CreateSandboxBaseParams \{#createsandboxbaseparams\}

```python
class CreateSandboxBaseParams(BaseModel)
```

新しいサンドボックスを作成するための基本パラメータ。

**属性**:

* `name` *str | None* - サンドボックスの名前。
* `language` *CodeLanguage | CodeLanguageLiteral | None* - サンドボックスで使用するプログラミング言語。
  デフォルトは &quot;python&quot;。
* `os_user` *str | None* - サンドボックス用の OS ユーザー。
* `env_vars` *dict[str, str] | None* - サンドボックス内で設定する環境変数。
* `labels` *dict[str, str] | None* - サンドボックスに付与するカスタムラベル。
* `public` *bool | None* - サンドボックスを公開にするかどうか。
* `timeout` *float | None* - サンドボックスが作成および起動されるまでのタイムアウト（秒）。
* `auto_stop_interval` *int | None* - その時間中にサンドボックスイベントが発生しなかった場合に、
  その後サンドボックスが自動停止するまでの時間（分）。デフォルトは 15 分。
  0 は自動停止なしを意味します。
* `auto_archive_interval` *int | None* - 継続して停止状態にあるサンドボックスが
  自動的にアーカイブされるまでの時間（分）。デフォルトは 7 日。
  0 の場合は最大の間隔が使用されます。
* `auto_delete_interval` *int | None* - 継続して停止状態にあるサンドボックスが
  自動的に削除されるまでの時間（分）。デフォルトでは自動削除は無効です。
  負の値は無効、0 は停止と同時に即時削除を意味します。
* `volumes` *list[VolumeMount] | None* - サンドボックスにアタッチするボリュームマウントのリスト。
* `network_block_all` *bool | None* - サンドボックスのすべてのネットワークアクセスをブロックするかどうか。
* `network_allow_list` *str | None* - サンドボックスで許可される CIDR ネットワークアドレスのカンマ区切りリスト。
* `ephemeral` *bool | None* - サンドボックスを一時的（ephemeral）にするかどうか。
  True の場合、auto&#95;delete&#95;interval は 0 に設定されます。

## CreateSandboxFromImageParams \{#createsandboxfromimageparams\}

```python
class CreateSandboxFromImageParams(CreateSandboxBaseParams)
```

イメージから新しいサンドボックスを作成するためのパラメータ。

**属性**:

* `image` *str | Image* - サンドボックスで使用するカスタム Docker イメージ。Image オブジェクトが指定された場合、
  イメージは動的にビルドされます。
* `resources` *Resources | None* - サンドボックスのリソース設定。指定しない場合、サンドボックスは
  既定のリソースを使用します。

## CreateSandboxFromSnapshotParams \{#createsandboxfromsnapshotparams\}

```python
class CreateSandboxFromSnapshotParams(CreateSandboxBaseParams)
```

スナップショットから新しいサンドボックスを作成するためのパラメータ。

**属性**:

* `snapshot` *str | None* - サンドボックスに使用するスナップショット名。
