---
title: "AsyncSnapshot"
hideTitleOnPage: true
---

## スナップショット \{#snapshot\}

```python
class Snapshot(SyncSnapshotDto)
```

事前構成されたサンドボックスである Daytona スナップショットを表します。

**属性**:

* `id` *str* - スナップショットの一意の識別子。
* `organization_id` *str | None* - スナップショットの組織 ID。
* `general` *bool* - スナップショットが汎用かどうか。
* `name` *str* - スナップショット名。
* `image_name` *str* - スナップショットのイメージ名。
* `state` *str* - スナップショットの状態。
* `size` *float | int | None* - スナップショットのサイズ。
* `entrypoint` *list[str] | None* - スナップショットのエントリポイント。
* `cpu` *float | int* - スナップショットに割り当てられた CPU。
* `gpu` *float | int* - スナップショットに割り当てられた GPU。
* `mem` *float | int* - スナップショットに割り当てられたメモリ（GiB 単位）。
* `disk` *float | int* - スナップショットに割り当てられたディスク（GiB 単位）。
* `error_reason` *str | None* - スナップショットのエラー理由。
* `created_at` *str* - スナップショットが作成されたタイムスタンプ。
* `updated_at` *str* - スナップショットが最後に更新されたタイムスタンプ。
* `last_used_at` *str* - スナップショットが最後に使用されたタイムスタンプ。

## AsyncSnapshotService \{#asyncsnapshotservice\}

```python
class AsyncSnapshotService()
```

Daytona のスナップショットを管理するサービス。スナップショットの一覧、取得、作成、削除を行えます。

#### AsyncSnapshotService.list \{#asyncsnapshotservicelist\}

```python
@intercept_errors(message_prefix="スナップショットの一覧取得に失敗しました: ")
@with_instrumentation()
async def list(page: int | None = None,
               limit: int | None = None) -> PaginatedSnapshots
```

スナップショットのページ分割リストを返します。

**引数**:

* `page` *int | None* - ページ番号（1から開始）。
* `limit` *int | None* - 1ページあたりの最大件数。

**戻り値**:

* `PaginatedSnapshots` - ページ分割されたスナップショットのリスト。

**例**:

```python
async with AsyncDaytona() as daytona:
    result = await daytona.snapshot.list(page=2, limit=10)
    for snapshot in result.items:
        print(f"{snapshot.name} ({snapshot.image_name})")
```

#### AsyncSnapshotService.delete \{#asyncsnapshotservicedelete\}

```python
@intercept_errors(message_prefix="スナップショットの削除に失敗しました: ")
@with_instrumentation()
async def delete(snapshot: Snapshot) -> None
```

スナップショットを削除します。

**引数**:

* `snapshot` *スナップショット* - 削除するスナップショット。

**例**:

```python
async with AsyncDaytona() as daytona:
    snapshot = await daytona.snapshot.get("test-snapshot")
    await daytona.snapshot.delete(snapshot)
    print("スナップショットが削除されました")
```

#### AsyncSnapshotService.get \{#asyncsnapshotserviceget\}

```python
@intercept_errors(message_prefix="スナップショットの取得に失敗しました: ")
@with_instrumentation()
async def get(name: str) -> Snapshot
```

名前を指定してスナップショットを取得します。

**引数**:

* `name` *str* - 取得するスナップショットの名前。

**戻り値**:

* `Snapshot` - スナップショットのオブジェクト。

**例**:

```python
async with AsyncDaytona() as daytona:
    snapshot = await daytona.snapshot.get("test-snapshot-name")
    print(f"{snapshot.name} ({snapshot.image_name})")
```

#### AsyncSnapshotService.create \{#asyncsnapshotservicecreate\}

```python
@intercept_errors(message_prefix="Failed to create snapshot: ")
@with_timeout()
@with_instrumentation()
async def create(params: CreateSnapshotParams,
                 *,
                 on_logs: Callable[[str], None] | None = None,
                 timeout: float | None = 0) -> Snapshot
```

指定されたイメージ定義から新しいスナップショットを作成して登録します。

**引数**:

* `params` *CreateSnapshotParams* - スナップショット作成用のパラメータ。
* `on_logs` *Callable[[str], None]* - スナップショット作成時のログを処理するコールバック関数。
* `timeout` *float | None* - 既定はタイムアウトなし。秒単位のタイムアウト（0 はタイムアウトなし）。

**例**:

```python
image = Image.debianSlim('3.12').pipInstall('numpy')
daytona.snapshot.create(
    CreateSnapshotParams(name='my-snapshot', image=image),
    on_logs=lambda chunk: print(chunk, end=""),
)
```

#### AsyncSnapshotService.activate \{#asyncsnapshotserviceactivate\}

```python
@with_instrumentation()
async def activate(snapshot: Snapshot) -> Snapshot
```

スナップショットを有効化します。

**引数**:

* `snapshot` *スナップショット* - スナップショットのインスタンス。

**返り値**:

* `Snapshot` - 有効化されたスナップショットのインスタンス。

#### AsyncSnapshotService.process_image_context \{#asyncsnapshotserviceprocess_image_context\}

```python
@staticmethod
@with_instrumentation()
async def process_image_context(object_storage_api: ObjectStorageApi,
                                image: Image) -> list[str]
```

オブジェクトストレージへアップロードして画像コンテキストを処理します。

**引数**:

* `image` *Image* - Image のインスタンス。

**戻り値**:

* `List[str]` - オブジェクトストレージに保存されたコンテキストハッシュのリスト。

## ページネーションされたスナップショット \{#paginatedsnapshots\}

```python
class PaginatedSnapshots(PaginatedSnapshotsDto)
```

Daytona のスナップショットのページネーション対応リストを表します。

**属性**:

* `items` *List[Snapshot]* - 現在のページに含まれるスナップショットインスタンスの一覧。
* `total` *int* - 全ページ合計のスナップショット総数。
* `page` *int* - 現在のページ番号。
* `total_pages` *int* - 利用可能なページの総数。

## CreateSnapshotParams \{#createsnapshotparams\}

```python
class CreateSnapshotParams(BaseModel)
```

新しいスナップショットを作成するためのパラメータ。

**属性**:

* `name` *str* - スナップショットの名前。
* `image` *str | Image* - スナップショットのイメージ。文字列が指定された場合は、
  そのイメージがいずれかのレジストリで利用可能である必要があります。`Image` インスタンスが指定された場合は、
  Daytona 内で新しいイメージを作成するために使用されます。
* `resources` *Resources | None* - スナップショットに割り当てるリソース。
* `entrypoint` *list[str] | None* - スナップショットのエントリーポイント。
* `region_id` *str | None* - スナップショットが利用可能になるリージョンの ID。
  指定されていない場合は、組織のデフォルトリージョンが使用されます。
