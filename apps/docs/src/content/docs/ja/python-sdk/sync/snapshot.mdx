---
title: "スナップショット"
hideTitleOnPage: true
---

## スナップショット \{#snapshot\}

```python
class Snapshot(SnapshotDto)
```

事前構成済みのサンドボックスである Daytona のスナップショットを表します。

**属性**:

* `id` *StrictStr* - スナップショットの一意の識別子。
* `organization_id` *Optional[StrictStr]* - スナップショットの所属する組織 ID。
* `general` *Optional[bool]* - スナップショットが汎用かどうか。
* `name` *StrictStr* - スナップショット名。
* `image_name` *StrictStr* - スナップショットのイメージ名。
* `state` *StrictStr* - スナップショットの状態。
* `size` *Optional[Union[StrictFloat, StrictInt]]* - スナップショットのサイズ。
* `entrypoint` *Optional[List[str]]* - スナップショットのエントリポイント。
* `cpu` *Union[StrictFloat, StrictInt]* - スナップショットの CPU 仕様。
* `gpu` *Union[StrictFloat, StrictInt]* - スナップショットの GPU 仕様。
* `mem` *Union[StrictFloat, StrictInt]* - スナップショットのメモリ（GiB）。
* `disk` *Union[StrictFloat, StrictInt]* - スナップショットのディスク（GiB）。
* `error_reason` *Optional[StrictStr]* - エラー理由。
* `created_at` *StrictStr* - 作成時刻（タイムスタンプ）。
* `updated_at` *StrictStr* - 最終更新時刻（タイムスタンプ）。
* `last_used_at` *StrictStr* - 最終使用時刻（タイムスタンプ）。

## スナップショットサービス \{#snapshotservice\}

```python
class SnapshotService()
```

Daytonaのスナップショットを管理するサービス。スナップショットの一覧表示、取得、作成、削除に利用できます。

#### SnapshotService.list \{#snapshotservicelist\}

```python
@intercept_errors(message_prefix="スナップショットの一覧取得に失敗しました: ")
def list(page: Optional[int] = None,
         limit: Optional[int] = None) -> PaginatedSnapshots
```

スナップショットのページ分割された一覧を返します。

**引数**:

* `page` *Optional[int]* - ページ番号（1から開始）。
* `limit` *Optional[int]* - 1ページあたりの最大件数。

**戻り値**:

* `PaginatedSnapshots` - ページ分割されたスナップショットの一覧。

**例**:

```python
daytona = Daytona()
result = daytona.snapshot.list(page=2, limit=10)
for snapshot in result.items:
    print(f"{snapshot.name} ({snapshot.image_name})")
```

#### SnapshotService.delete \{#snapshotservicedelete\}

```python
@intercept_errors(message_prefix="スナップショットの削除に失敗しました: ")
def delete(snapshot: Snapshot) -> None
```

スナップショットを削除します。

**引数**:

* `snapshot` *スナップショット* - 削除するスナップショット。

**例**:

```python
daytona = Daytona()
snapshot = daytona.snapshot.get("test-snapshot")
daytona.snapshot.delete(snapshot)
print("スナップショットが削除されました")
```

#### SnapshotService.get \{#snapshotserviceget\}

```python
@intercept_errors(message_prefix="スナップショットの取得に失敗しました: ")
def get(name: str) -> Snapshot
```

名前を指定してスナップショットを取得します。

**引数**:

* `name` *str* - 取得するスナップショットの名前。

**戻り値**:

* `Snapshot` - スナップショットのオブジェクト。

**例**:

```python
daytona = Daytona()
snapshot = daytona.snapshot.get("test-snapshot-name")
print(f"{snapshot.name} ({snapshot.image_name})")
```

#### SnapshotService.create \{#snapshotservicecreate\}

```python
@intercept_errors(message_prefix="スナップショットの作成に失敗しました: ")
@with_timeout(error_message=lambda self, timeout: (
    f"タイムアウト期間{timeout}秒以内にスナップショットを作成できませんでした。"))
def create(params: CreateSnapshotParams,
           *,
           on_logs: Callable[[str], None] = None,
           timeout: Optional[float] = 0) -> Snapshot
```

指定された Image 定義から新しいスナップショットを作成して登録します。

**引数**:

* `params` *CreateSnapshotParams* - スナップショット作成用のパラメータ。
* `on_logs` *Callable[[str], None]* - スナップショット作成時のログを処理するコールバック関数。
* `timeout` *Optional[float]* - 既定値はタイムアウトなし。秒で指定（0 はタイムアウトなし）。

**例**:

```python
image = Image.debianSlim('3.12').pipInstall('numpy')
daytona.snapshot.create(
    CreateSnapshotParams(name='my-snapshot', image=image),
    on_logs=lambda chunk: print(chunk, end=""),
)
```

#### SnapshotService.activate \{#snapshotserviceactivate\}

```python
def activate(snapshot: スナップショット) -> スナップショット
```

スナップショットを有効化します。

**引数**:

* `snapshot` *スナップショット* - スナップショットのインスタンス。

**戻り値**:

* `Snapshot` - 有効化されたスナップショットのインスタンス。

#### SnapshotService.process_image_context \{#snapshotserviceprocess_image_context\}

```python
@staticmethod
def process_image_context(object_storage_api: ObjectStorageApi,
                          image: Image) -> List[str]
```

画像のコンテキストをオブジェクトストレージにアップロードして処理します。

**引数**:

* `image` *Image* - Image インスタンス。

**返り値**:

* `List[str]` - オブジェクトストレージに保存されたコンテキストハッシュのリスト。

## ページ分割されたスナップショット \{#paginatedsnapshots\}

```python
class PaginatedSnapshots(PaginatedSnapshotsDto)
```

Daytona のスナップショットのページネートされたリストを表します。

**属性**:

* `items` *List[Snapshot]* - 現在のページに含まれるスナップショットインスタンスの一覧。
* `total` *int* - すべてのページを通したスナップショットの総数。
* `page` *int* - 現在のページ番号。
* `total_pages` *int* - 利用可能なページ総数。

## CreateSnapshotParams \{#createsnapshotparams\}

```python
class CreateSnapshotParams(BaseModel)
```

新しいスナップショットを作成するためのパラメータ。

**属性**:

* `name` *Optional[str]* - スナップショットの名前。
* `image` *Union[str, Image]* - スナップショットのイメージ。文字列が指定された場合は、
  いずれかのレジストリで利用可能である必要があります。Image インスタンスが指定された場合は、
  Daytona 上で新しいイメージを作成する際に使用されます。
* `resources` *Optional[Resources]* - スナップショットのリソース。
* `entrypoint` *Optional[List[str]]* - スナップショットのエントリポイント。
* `region_id` *Optional[str]* - スナップショットを利用可能にするリージョンの ID。
  指定しない場合は、組織のデフォルトリージョンが使用されます。
