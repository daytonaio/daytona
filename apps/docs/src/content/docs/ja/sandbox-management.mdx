---
title: Sandbox管理
---

import sandboxDiagram from '@assets/docs/sandbox-states.svg?raw'
import { TabItem, Tabs } from '@astrojs/starlight/components'
import Image from 'astro/components/Image.astro'

SandboxはDaytonaによって管理される分離された開発環境です。このガイドでは、SDKを使用してSandboxを作成、管理、削除する方法について説明します。
デフォルトでは、Sandboxは15分間の非アクティブ状態後に自動停止し、**1 vCPU**、**1GB RAM**、**3GiBディスク**を使用します。

## Sandboxのライフサイクル

ライフサイクル全体を通して、Daytona Sandboxはいくつかの異なる状態を持つことができます。以下の図は、状態とそれらの間で可能な遷移を示しています。

<Fragment set:html={sandboxDiagram} />

デフォルトでは、sandboxは`15分`の非アクティブ状態後に自動停止し、停止してから`7日`後に自動アーカイブされます。Sandboxを中断なく無期限に実行し続けるには、作成時に自動停止値を`0`に設定してください。

## Sandboxの作成

Daytona SDKは、デフォルトまたはカスタム設定でSandboxを作成するオプションを提供します。Sandboxの言語、[Snapshot](/docs/ja/snapshots)、リソース、環境変数、ボリュームを指定できます。
実行中のSandboxはCPU、メモリ、ディスクストレージを使用します。すべてのリソースは使用時間に応じて秒単位で課金されます。

:::tip
自動停止間隔を延長したい場合は、Sandboxを作成する際に[自動停止間隔パラメータを設定](/docs/ja/sandbox-management#auto-stop-interval)できます。
:::

### 基本的なSandboxの作成

Daytona SDKは、PythonとTypeScriptを使用して、デフォルト設定、特定の言語、またはカスタムラベルでSandboxを作成するメソッドを提供します。

<Tabs>
<TabItem label="Python" icon="seti:python">
```python
from daytona import Daytona, CreateSandboxFromSnapshotParams

daytona = Daytona()

# 基本的なSandboxを作成

sandbox = daytona.create()

# 特定の言語でSandboxを作成

params = CreateSandboxFromSnapshotParams(language="python")
sandbox = daytona.create(params)

# カスタムラベルでSandboxを作成

params = CreateSandboxFromSnapshotParams(labels={"SOME_LABEL": "my-label"})
sandbox = daytona.create(params)

```
</TabItem>

<TabItem label="TypeScript" icon="seti:typescript">
```typescript
import { Daytona } from '@daytonaio/sdk';

const daytona = new Daytona();

// 基本的なSandboxを作成
const sandbox = await daytona.create();

// 特定の言語でSandboxを作成
const sandbox = await daytona.create({ language: 'typescript' });

// カスタムラベルでSandboxを作成
const sandbox = await daytona.create({ labels: { SOME_LABEL: 'my-label' } });
```

</TabItem>
</Tabs>

Sandboxが積極的に使用されていない場合は、停止することが推奨されます。これは[stopコマンドを使用](/docs/ja/sandbox-management#stop-and-start-sandbox)して手動で行うか、[自動停止間隔を設定](/docs/ja/sandbox-management#auto-stop-and-auto-archive)して自動的に行うことができます。

:::note
DaytonaはデフォルトのSnapshotを使用してウォームSandboxのプールを保持しています。  
利用可能な場合、Sandboxはコールドブートではなくミリ秒で起動します。
:::

### Sandboxリソース

Daytona Sandboxはデフォルトで**1 vCPU**、**1GB RAM**、**3GiBディスク**を提供します。

より多くのパワーが必要ですか？`Resources`クラスを使用して必要なものを正確に定義してください：CPU、メモリ、ディスク容量はすべてカスタマイズ可能です。

利用可能なリソースと制限は[ダッシュボード](https://app.daytona.io/dashboard/limits)で確認してください。

<Tabs>
<TabItem label="Python" icon="seti:python">
```python
from daytona import Daytona, Resources, CreateSandboxFromImageParams, Image

daytona = Daytona()

# カスタムリソースでSandboxを作成

resources = Resources(
    cpu=2,  # 2 CPUコア
    memory=4,  # 4GB RAM
    disk=8,  # 8GBディスク容量
)

params = CreateSandboxFromImageParams(
    image=Image.debian_slim("3.12"),
    resources=resources
)

sandbox = daytona.create(params)

```
</TabItem>
<TabItem label="TypeScript" icon="seti:typescript">
```typescript
import { Daytona, Image } from "@daytonaio/sdk";

async function main() {
  const daytona = new Daytona();

  // カスタムリソースでSandboxを作成
  const sandbox = await daytona.create({
    image: Image.debianSlim("3.13"),
    resources: {
      cpu: 2, // 2 CPUコア
      memory: 4, // 4GB RAM
      disk: 8, // 8GBディスク容量
    },
  });
}

main();
```

</TabItem>
</Tabs>

:::note
すべてのリソースパラメータはオプションです。指定されていない場合、Daytonaは選択された言語とユースケースに適したデフォルト値を使用します。
:::

## Sandboxの情報

Daytona SDKは、PythonとTypeScriptを使用してSandboxのID、ルートディレクトリ、ステータスなどの情報を取得するメソッドを提供します。

<Tabs>
<TabItem label="Python" icon="seti:python">
```python
# Sandbox IDを取得
sandbox_id = sandbox.id

# Sandboxユーザーのルートディレクトリを取得

root_dir = sandbox.get_user_root_dir()

# Sandbox ID、自動停止間隔、状態を取得

print(sandbox.id)
print(sandbox.auto_stop_interval)
print(sandbox.state)

```

</TabItem>
<TabItem label="TypeScript" icon="seti:typescript">
```typescript
// Sandbox IDを取得
const sandboxId = sandbox.id;

// Sandboxユーザーのルートディレクトリを取得
const rootDir = await sandbox.getUserRootDir();

// Sandbox ID、自動停止間隔、状態を取得
console.log(sandbox.id)
console.log(sandbox.autoStopInterval)
console.log(sandbox.state)
```

</TabItem>
</Tabs>

特定のポートのプレビューURLを取得するには、[プレビューと認証](/docs/ja/preview-and-authentication)をご確認ください。

## Sandboxの停止と開始

Daytona SDKは、PythonとTypeScriptを使用してSandboxを停止および開始するメソッドを提供します。

停止されたSandboxは、メモリ状態がクリアされる一方で、ファイルシステムの永続性を維持します。これらはディスク使用量のコストのみが発生し、必要に応じて再度開始することができます。

<Tabs>
<TabItem label="Python" icon="seti:python">
```python
sandbox = daytona.create(CreateSandboxParams(language="python"))

# Sandboxを停止

sandbox.stop()

print(sandbox.id) # 7cd11133-96c1-4cc8-9baa-c757b8f8c916

# sandbox IDは後でsandboxを見つけて開始するために使用できます

sandbox = daytona.find_one("7cd11133-96c1-4cc8-9baa-c757b8f8c916")

# Sandboxを開始

sandbox.start()

```
</TabItem>
<TabItem label="TypeScript" icon="seti:typescript">
```typescript
const sandbox = await daytona.create({ language: 'typescript' });

// Sandboxを停止
await sandbox.stop();

console.log(sandbox.id) // 7cd11133-96c1-4cc8-9baa-c757b8f8c916

// sandbox IDは後でsandboxを見つけて開始するために使用できます

const sandbox = await daytona.findOne("7cd11133-96c1-4cc8-9baa-c757b8f8c916");

// Sandboxを開始
await sandbox.start();
```

</TabItem>
</Tabs>

停止状態は、Sandboxが近いうちに再度開始されることが予想される場合に使用すべきです。そうでなければ、ディスク使用量のコストを削減するために、Sandboxを停止してからアーカイブすることが推奨されます。

## Sandboxのアーカイブ

Daytona SDKは、PythonとTypeScriptを使用してSandboxをアーカイブするメソッドを提供します。

Sandboxがアーカイブされると、ファイルシステム全体の状態が非常にコスト効率の良いオブジェクトストレージに移動され、Sandboxを長期間利用可能な状態で保持することが可能になります。
アーカイブされたSandboxの開始は、そのサイズに応じて、停止されたSandboxの開始よりも時間がかかります。

Sandboxはアーカイブする前に停止する必要があり、停止されたSandboxと同じ方法で再度開始することができます。

<Tabs>
<TabItem label="Python" icon="seti:python">
```python
# Sandboxをアーカイブ
sandbox.archive()
```
</TabItem>
<TabItem label="TypeScript" icon="seti:typescript">
```typescript
// Sandboxをアーカイブ
await sandbox.archive();
```
</TabItem>
</Tabs>

## Sandboxを削除する

Daytona SDKは、PythonとTypeScriptを使用してSandboxを削除するメソッドを提供します。

<Tabs>
<TabItem label="Python" icon="seti:python">
```python
# Sandboxを削除
sandbox.delete()
```
</TabItem>
<TabItem label="TypeScript" icon="seti:typescript">
```typescript
// Sandboxを削除
await sandbox.delete();
```

</TabItem>
</Tabs>

:::tip
ターミナルを通じてSandboxを管理することを好む場合は、[Daytona CLI](/docs/ja/getting-started#setting-up-the-daytona-cli)をチェックしてください：

```bash
daytona sandbox list
```

```text

    Sandbox               State           Region        Last Event
    ────────────────────────────────────────────────────────────────────────────────────
    ugliest_quokka        STARTED         us            1 hour ago

    associated_yak        STARTED         us            14 hours ago

    developed_lemur       STARTED         us            17 hours ago

```

```bash
daytona sandbox start|stop|remove --all
```

```text
All sandboxes have been deleted
```

:::

## 自動ライフサイクル管理

Daytona Sandboxは、ユーザー定義の間隔に基づいて自動的に停止、アーカイブ、削除することができます。

### 自動停止間隔

自動停止間隔パラメータは、実行中のSandboxが自動的に停止されるまでの時間を設定します。

このパラメータは以下のいずれかに設定できます：

- 分単位の時間間隔
- `0`（自動停止機能を無効にし、サンドボックスを無期限に実行させる）

パラメータが設定されていない場合、デフォルトの間隔である`15`分が使用されます。

:::

<Tabs>
<TabItem label="Python" icon="seti:python">
```python
sandbox = daytona.create(CreateSandboxFromSnapshotParams(
    snapshot="my-snapshot-name",
    auto_stop_interval=0,  # 自動停止機能を無効にする - デフォルトは15分
))
```
</TabItem>
<TabItem label="TypeScript" icon="seti:typescript">
```typescript
const sandbox = await daytona.create({
    snapshot: "my-snapshot-name",
    autoStopInterval: 0, // 自動停止機能を無効にする - デフォルトは15分
});
```

</TabItem>
</Tabs>

### 自動アーカイブ間隔

自動アーカイブ間隔パラメータは、継続的に停止されているSandboxが自動的にアーカイブされるまでの時間を設定します。

このパラメータは以下のいずれかに設定できます：

- 分単位の時間間隔
- `0`（最大間隔の`30日`が使用される）

パラメータが設定されていない場合、デフォルトの間隔である`7日`が使用されます。

<Tabs>
<TabItem label="Python" icon="seti:python">
```python
sandbox = daytona.create(CreateSandboxFromSnapshotParams(
    snapshot="my-snapshot-name",
    auto_archive_interval=60 # Sandboxが1時間停止した後に自動アーカイブ
))
```
</TabItem>
<TabItem label="TypeScript" icon="seti:typescript">
```typescript
const sandbox = await daytona.create({
    snapshot: "my-snapshot-name",
    autoArchiveInterval: 60 // Sandboxが1時間停止した後に自動アーカイブ
});
```
</TabItem>
</Tabs>

### 自動削除間隔

自動削除間隔パラメータは、継続的に停止されているSandboxが自動的に削除されるまでの時間を設定します。デフォルトでは、Sandboxは自動的に削除されることはありません。

このパラメータは以下のいずれかに設定できます：

- 分単位の時間間隔
- `-1`（自動削除機能を無効にする）
- `0`（停止後すぐにSandboxが削除される）

パラメータが設定されていない場合、Sandboxは自動的に削除されません。

<Tabs>
<TabItem label="Python" icon="seti:python">
```python
sandbox = daytona.create(CreateSandboxFromSnapshotParams(
    snapshot="my-snapshot-name",
    auto_delete_interval=60,  # Sandboxが1時間停止した後に自動削除
))

# 停止後すぐにSandboxを削除

sandbox.set_auto_delete_interval(0)

# 自動削除を無効にする

sandbox.set_auto_delete_interval(-1)

```
</TabItem>
<TabItem label="TypeScript" icon="seti:typescript">
```typescript
const sandbox = await daytona.create({
    snapshot: "my-snapshot-name",
    autoDeleteInterval: 60, // Sandboxが1時間停止した後に自動削除
});

// 停止後すぐにSandboxを削除
await sandbox.setAutoDeleteInterval(0)

// 自動削除を無効にする
await sandbox.setAutoDeleteInterval(-1)
```

</TabItem>
</Tabs>

## 無期限で実行

デフォルトでは、Sandboxは15分間非アクティブ状態が続くと自動停止します。Sandboxを中断なく実行し続けるには、新しいSandboxを作成する際に自動停止間隔を`0`に設定します：

<Tabs>
<TabItem label="Python" icon="seti:python">
```python
sandbox = daytona.create(CreateSandboxFromSnapshotParams(
    snapshot="my-snapshot-name",
    auto_stop_interval=0,  # 自動停止機能を無効にします - デフォルトは15分です
))
```
</TabItem>
<TabItem label="TypeScript" icon="seti:typescript">
```typescript
const sandbox = await daytona.create({
    snapshot: "my-snapshot-name",
    autoStopInterval: 0, // 自動停止機能を無効にします - デフォルトは15分です
});
```
</TabItem>
</Tabs>
