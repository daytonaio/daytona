---
title: サンドボックス管理
---

import sandboxDiagram from '@assets/docs/sandbox-states.svg?raw'
import { TabItem, Tabs } from '@astrojs/starlight/components'
import Image from 'astro/components/Image.astro'

サンドボックスは、Daytona によって管理される分離された開発環境です。本ガイドでは、SDK を使用してサンドボックスを作成、管理、削除する方法を説明します。
既定では、サンドボックスは非アクティブ状態が 15 分続くと自動停止し、**1 vCPU**、**1GB RAM**、**3GiB ディスク**を使用します。

## サンドボックスのライフサイクル \{#sandbox-lifecycle\}

ライフサイクル全体を通して、Daytona のサンドボックスは複数の状態を取り得ます。下の図は、それらの状態と遷移の可能性を示しています。

<Fragment set:html={sandboxDiagram} />

デフォルトでは、サンドボックスは非アクティブな状態が`15 minutes`続くと自動停止し、停止後`7 days`で自動アーカイブされます。サンドボックスを中断なく無期限で稼働させるには、作成時に自動停止の値を`0`に設定してください。

## サンドボックスの作成 \{#creating-sandboxes\}

Daytona SDK では、デフォルトまたはカスタムの構成でサンドボックスを作成できます。サンドボックスに対して、言語、[スナップショット](/docs/ja/snapshots)、リソース、環境変数、ボリュームを指定できます。
稼働中のサンドボックスは CPU、メモリ、ディスクストレージを消費します。各リソースは使用した秒数に応じて課金されます。

:::tip
自動停止の間隔を延長したい場合は、サンドボックス作成時に[自動停止間隔のパラメータを設定](/docs/ja/sandbox-management#auto-stop-interval)できます。
:::

### 基本的なサンドボックスの作成 \{#basic-sandbox-creation\}

Daytona SDK は、Python および TypeScript で、デフォルト構成、特定の言語、カスタム名、またはカスタムラベルを指定してサンドボックスを作成するためのメソッドを提供します。

<Tabs syncKey="language">
  <TabItem label="Python" icon="seti:python">
    ```python
    from daytona import Daytona, CreateSandboxFromSnapshotParams

    daytona = Daytona()

    # 基本的なサンドボックスを作成
    sandbox = daytona.create()

    # 特定の言語でサンドボックスを作成
    params = CreateSandboxFromSnapshotParams(language="python")
    sandbox = daytona.create(params)

    # カスタム名のサンドボックスを作成
    params = CreateSandboxFromSnapshotParams(name="my-sandbox")
    sandbox = daytona.create(params)

    # カスタムラベルのサンドボックスを作成
    params = CreateSandboxFromSnapshotParams(labels={"SOME_LABEL": "my-label"})
    sandbox = daytona.create(params)
    ```
  </TabItem>

  <TabItem label="TypeScript" icon="seti:typescript">
    ```typescript
    import { Daytona } from '@daytonaio/sdk';

    const daytona = new Daytona();

    // 基本的なサンドボックスを作成
    const sandbox = await daytona.create();

    // 特定の言語でサンドボックスを作成
    const sandbox = await daytona.create({ language: 'typescript' });

    // カスタム名のサンドボックスを作成
    const sandbox = await daytona.create({ name: 'my-sandbox' });

    // カスタムラベルのサンドボックスを作成
    const sandbox = await daytona.create({ labels: { SOME_LABEL: 'my-label' } });
    ```
  </TabItem>
</Tabs>

:::note
**サンドボックス名**: `name` パラメータでサンドボックスにカスタム名を指定できます。未指定の場合はサンドボックス ID が名前として使用されます。サンドボックス名は再利用可能で、特定の名前のサンドボックスが破棄されると、その名前は再び使用できます。
:::

参照: [create (Python SDK)](/docs/ja/python-sdk/sync/daytona#daytonacreate), [create (TypeScript SDK)](/docs/ja/typescript-sdk/daytona#create)

サンドボックスがアクティブに使用されていない場合は、停止することを推奨します。これは [stop コマンドの使用](/docs/ja/sandbox-management#stop-and-start-sandbox)により手動で、または[自動停止間隔の設定](/docs/ja/sandbox-management#auto-stop-and-auto-archive)により自動で実行できます。

:::note
Daytona はデフォルトのスナップショットを用いたウォーム状態のサンドボックスプールを維持しています。\
利用可能な場合、サンドボックスはコールドブートではなくミリ秒で起動します。
:::

### サンドボックスのリソース \{#sandbox-resources\}

Daytona のサンドボックスは、既定で **1 vCPU**、**1GB RAM**、**3GiB ディスク**が付与されます。

必要なリソースを正確に指定するには `Resources` クラスを使用します。CPU、メモリ、ディスク容量はすべてカスタマイズ可能です。

組織には、サンドボックスのリソース上限として 4 vCPU、8GB RAM、10GB ディスクが設定されています。より高いリソースが必要な場合は、[support@daytona.io](mailto:support@daytona.io) までユースケースを添えてご連絡ください。

利用可能なリソースと上限は [ダッシュボード](https://app.daytona.io/dashboard/limits) で確認できます。

<Tabs syncKey="language">
  <TabItem label="Python" icon="seti:python">
    ```python
    from daytona import Daytona, Resources, CreateSandboxFromImageParams, Image

    daytona = Daytona()

    # Create a Sandbox with custom resources

    resources = Resources(
        cpu=2,  # 2 CPU cores
        memory=4,  # 4GB RAM
        disk=8,  # 8GB disk space
    )

    params = CreateSandboxFromImageParams(
        image=Image.debian_slim("3.12"),
        resources=resources
    )

    sandbox = daytona.create(params)

    ```
  </TabItem>

  <TabItem label="TypeScript" icon="seti:typescript">
    ```typescript
    import { Daytona, Image } from "@daytonaio/sdk";

    async function main() {
      const daytona = new Daytona();

      # Create a Sandbox with custom resources
      const sandbox = await daytona.create({
        image: Image.debianSlim("3.13"),
        resources: {
          cpu: 2, // 2 CPU cores
          memory: 4, // 4GB RAM
          disk: 8, // 8GB disk space
        },
      });
    }

    main();
    ```
  </TabItem>
</Tabs>

:::note
すべてのリソースパラメータは任意です。指定しない場合、Daytona は選択した言語とユースケースに適した既定値を使用します。
:::

### エフェメラルサンドボックス \{#ephemeral-sandboxes\}

エフェメラルサンドボックスは、停止されると自動的に削除されるサンドボックスです。短時間の作業やテスト用途に便利です。

エフェメラルサンドボックスを作成するには、サンドボックス作成時に `ephemeral` を `True` に設定します:

<Tabs syncKey="language">
  <TabItem label="Python" icon="seti:python">
    ```python
    from daytona import Daytona, CreateSandboxFromSnapshotParams

    daytona = Daytona()

    # エフェメラルサンドボックスを作成

    params = CreateSandboxFromSnapshotParams(
      ephemeral=True,
      auto_stop_interval=5 # 非アクティブな状態が5分続くと、このエフェメラルサンドボックスは削除されます
    )
    sandbox = daytona.create(params)
    ```
  </TabItem>

  <TabItem label="TypeScript" icon="seti:typescript">
    ```typescript
    import { Daytona } from '@daytonaio/sdk';

    const daytona = new Daytona();

    // エフェメラルサンドボックスを作成
    const sandbox = await daytona.create({
      ephemeral: true,
      autoStopInterval: 5 // 非アクティブな状態が5分続くと、このエフェメラルサンドボックスは削除されます
    });
    ```
  </TabItem>
</Tabs>

:::note
[&quot;autoDeleteInterval: 0&quot;](#auto-delete-interval) を設定すると、&quot;ephemeral&quot; を `true` に設定した場合と同じ効果になります。
:::

### ネットワーク設定（ファイアウォール） \{#network-settings-firewall\}

Daytona のサンドボックスは、セキュリティ強化と接続性の管理のために、設定可能なネットワークファイアウォール機能を提供します。既定ではネットワークアクセスは標準的なセキュリティポリシーに従いますが、サンドボックス作成時にネットワーク設定をカスタマイズできます。
ネットワーク制限の詳細は、[Network Limits](/docs/ja/network-limits) ドキュメントをご参照ください。

## サンドボックス情報 \{#sandbox-information\}

Daytona SDK には、Python および TypeScript を用いて、ID・ルートディレクトリ・ステータスなどサンドボックスに関する情報を取得するためのメソッドが用意されています。

<Tabs syncKey="language">
  <TabItem label="Python" icon="seti:python">
    ```python
    # サンドボックス ID の取得
    sandbox_id = sandbox.id

    # サンドボックスユーザーのルートディレクトリを取得
    root_dir = sandbox.get_user_root_dir()

    # サンドボックスの ID、自動停止間隔、状態を取得
    print(sandbox.id)
    print(sandbox.auto_stop_interval)
    print(sandbox.state)
    ```
  </TabItem>

  <TabItem label="TypeScript" icon="seti:typescript">
    ```typescript
    // サンドボックス ID の取得
    const sandboxId = sandbox.id;

    // サンドボックスユーザーのルートディレクトリを取得
    const rootDir = await sandbox.getUserRootDir();

    // サンドボックスの ID、自動停止間隔、状態を取得
    console.log(sandbox.id)
    console.log(sandbox.autoStopInterval)
    console.log(sandbox.state)
    ```
  </TabItem>
</Tabs>

特定のポートのプレビュー URL を取得する方法については、[Preview &amp; Authentication](/docs/ja/preview-and-authentication) を参照してください。

## サンドボックスの停止と開始 \{#stop-and-start-sandbox\}

Daytona SDK では、Python および TypeScript でサンドボックスを停止・開始するためのメソッドを提供しています。

停止したサンドボックスはファイルシステムの内容は保持されますが、メモリ状態はクリアされます。ディスク使用分のコストのみが発生し、必要に応じて再度起動できます。

<Tabs syncKey="language">
  <TabItem label="Python" icon="seti:python">
    ```python
    sandbox = daytona.create(CreateSandboxParams(language="python"))

    # Stop Sandbox

    sandbox.stop()

    print(sandbox.id) # 7cd11133-96c1-4cc8-9baa-c757b8f8c916

    # The sandbox ID can later be used to find the sandbox and start it

    sandbox = daytona.find_one("7cd11133-96c1-4cc8-9baa-c757b8f8c916")

    # Start Sandbox

    sandbox.start()

    ```
  </TabItem>

  <TabItem label="TypeScript" icon="seti:typescript">
    ```typescript
    const sandbox = await daytona.create({ language: 'typescript' });

    // Stop Sandbox
    await sandbox.stop();

    console.log(sandbox.id) // 7cd11133-96c1-4cc8-9baa-c757b8f8c916

    // The sandbox ID can later be used to find the sandbox and start it

    const sandbox = await daytona.findOne("7cd11133-96c1-4cc8-9baa-c757b8f8c916");

    // Start Sandbox
    await sandbox.start();
    ```
  </TabItem>
</Tabs>

参照: [stop (Python SDK)](/docs/python-sdk/sync/sandbox#sandboxstop), [start (Python SDK)](/docs/python-sdk/sync/sandbox#sandboxstart), [find&#95;one (Python SDK)](/docs/python-sdk/sync/daytona#daytonafind_one), [stop (TypeScript SDK)](/docs/typescript-sdk/sandbox#stop), [start (TypeScript SDK)](/docs/typescript-sdk/sandbox#start), [findOne (TypeScript SDK)](/docs/typescript-sdk/daytona#findone)

サンドボックスを近く再起動する見込みがある場合は、停止状態を利用してください。そうでない場合は、停止後にアーカイブしてディスク使用コストを抑えることを推奨します。

## サンドボックスのアーカイブ \{#archive-sandbox\}

Daytona SDK は、Python と TypeScript でサンドボックスをアーカイブするためのメソッドを提供します。

サンドボックスをアーカイブすると、ファイルシステムの状態全体が高いコスト効率のオブジェクトストレージへ移され、サンドボックスを長期間にわたり利用可能な状態で保持できます。
アーカイブされたサンドボックスの起動には、そのサイズに応じて、停止中のサンドボックスを起動するよりも時間がかかります。

サンドボックスはアーカイブ前に停止している必要があり、停止中のサンドボックスと同様に再起動できます。

<Tabs syncKey="language">
  <TabItem label="Python" icon="seti:python">
    ```python
    # サンドボックスをアーカイブ
    sandbox.archive()
    ```
  </TabItem>

  <TabItem label="TypeScript" icon="seti:typescript">
    ```typescript
    // サンドボックスをアーカイブ
    await sandbox.archive();
    ```
  </TabItem>
</Tabs>

参照: [archive (Python SDK)](/docs/python-sdk/sync/sandbox#sandboxarchive), [archive (TypeScript SDK)](/docs/typescript-sdk/sandbox#archive)

## サンドボックスの削除 \{#delete-sandbox\}

Daytona SDK には、Python と TypeScript でサンドボックスを削除するためのメソッドが用意されています。

<Tabs syncKey="language">
  <TabItem label="Python" icon="seti:python">
    ```python
    # サンドボックスを削除
    sandbox.delete()
    ```
  </TabItem>

  <TabItem label="TypeScript" icon="seti:typescript">
    ```typescript
    // サンドボックスを削除
    await sandbox.delete();
    ```
  </TabItem>
</Tabs>

参照: [delete（Python SDK）](/docs/python-sdk/sync/sandbox#sandboxdelete), [delete（TypeScript SDK）](/docs/typescript-sdk/sandbox#delete)

:::tip
ターミナルでサンドボックスを管理したい場合は、[Daytona CLI](/docs/ja/getting-started#setting-up-the-daytona-cli)をご確認ください。

```bash
daytona sandbox list
```

```text
サンドボックス        状態            リージョン    最終イベント
───────────────────────────────────────────────────────────────────────────
ugliest_quokka        STARTED         us            1時間前

associated_yak        STARTED         us            14時間前

developed_lemur       STARTED         us            17時間前
```

```bash
daytona sandbox start|stop|remove --all
```

```text
すべてのサンドボックスが削除されました
```

:::

## 自動ライフサイクル管理 \{#automated-lifecycle-management\}

Daytonaのサンドボックスは、ユーザーが指定した間隔に基づいて、自動的に停止、アーカイブ、削除できます。

### 自動停止間隔 \{#auto-stop-interval\}

自動停止間隔パラメータは、実行中のサンドボックスが自動的に停止されるまでの時間を設定します。

SDK の API 呼び出しや [プレビュー URL](/docs/ja/preview-and-authentication) 経由のネットワークリクエストなど、サンドボックスでアクティビティが発生すると、自動停止タイマーはリセットされます。

このパラメータには次のいずれかを設定できます:

* 分単位の時間間隔
* `0`（自動停止機能を無効にし、サンドボックスを無期限に実行可能にする）

パラメータが未設定の場合、デフォルトの間隔は `15` 分です。

<Tabs syncKey="language">
  <TabItem label="Python" icon="seti:python">
    ```python
    sandbox = daytona.create(CreateSandboxFromSnapshotParams(
        snapshot="my-snapshot-name",
        auto_stop_interval=0,  # 自動停止機能を無効化（デフォルトは15分）
    ))
    ```
  </TabItem>

  <TabItem label="TypeScript" icon="seti:typescript">
    ```typescript
    const sandbox = await daytona.create({
        snapshot: "my-snapshot-name",
        autoStopInterval: 0, // 自動停止機能を無効化（デフォルトは15分）
    });
    ```
  </TabItem>
</Tabs>

### 自動アーカイブ間隔 \{#auto-archive-interval\}

自動アーカイブ間隔パラメータは、停止状態が継続しているサンドボックスを自動的にアーカイブするまでの時間を設定します。

このパラメータには次のいずれかを設定できます:

* 分単位の時間間隔
* `0`（最大間隔である`30 days`が使用されます）

パラメータを設定しない場合は、既定の`7 days`が使用されます。

<Tabs syncKey="language">
  <TabItem label="Python" icon="seti:python">
    ```python
    sandbox = daytona.create(CreateSandboxFromSnapshotParams(
        snapshot="my-snapshot-name",
        auto_archive_interval=60 # サンドボックスが1時間停止し続けた場合に自動アーカイブ
    ))
    ```
  </TabItem>

  <TabItem label="TypeScript" icon="seti:typescript">
    ```typescript
    const sandbox = await daytona.create({
        snapshot: "my-snapshot-name",
        autoArchiveInterval: 60 // サンドボックスが1時間停止し続けた場合に自動アーカイブ
    });
    ```
  </TabItem>
</Tabs>

### 自動削除間隔 \{#auto-delete-interval\}

自動削除間隔パラメータは、停止したままのサンドボックスが自動的に削除されるまでの時間を設定します。デフォルトでは、サンドボックスは自動的に削除されません。

このパラメータには次のいずれかを設定できます:

* 分単位の時間間隔
* `-1`（自動削除機能を無効化）
* `0`（停止後に即時削除）

パラメータが未設定の場合、サンドボックスは自動的に削除されません。

<Tabs syncKey="language">
  <TabItem label="Python" icon="seti:python">
    ```python
    sandbox = daytona.create(CreateSandboxFromSnapshotParams(
        snapshot="my-snapshot-name",
        auto_delete_interval=60,  # サンドボックスが1時間停止し続けたら自動削除
    ))

    # 停止後にサンドボックスを即時削除

    sandbox.set_auto_delete_interval(0)

    # 自動削除を無効化

    sandbox.set_auto_delete_interval(-1)

    ```
  </TabItem>

  <TabItem label="TypeScript" icon="seti:typescript">
    ```typescript
    const sandbox = await daytona.create({
        snapshot: "my-snapshot-name",
        autoDeleteInterval: 60, // サンドボックスが1時間停止し続けたら自動削除
    });

    // 停止後にサンドボックスを即時削除
    await sandbox.setAutoDeleteInterval(0)

    // 自動削除を無効化
    await sandbox.setAutoDeleteInterval(-1)
    ```
  </TabItem>
</Tabs>

## 無期限で実行する \{#run-indefinitely\}

既定では、サンドボックスは非アクティブ状態が15分続くと自動停止します。中断なくサンドボックスを稼働させ続けるには、新しいサンドボックスを作成する際に自動停止間隔を `0` に設定します:

<Tabs syncKey="language">
  <TabItem label="Python" icon="seti:python">
    ```python
    sandbox = daytona.create(CreateSandboxFromSnapshotParams(
        snapshot="my-snapshot-name",
        auto_stop_interval=0,  # 自動停止機能を無効化（既定は15分）
    ))
    ```
  </TabItem>

  <TabItem label="TypeScript" icon="seti:typescript">
    ```typescript
    const sandbox = await daytona.create({
        snapshot: "my-snapshot-name",
        autoStopInterval: 0, // 自動停止機能を無効化（既定は15分）
    });
    ```
  </TabItem>
</Tabs>