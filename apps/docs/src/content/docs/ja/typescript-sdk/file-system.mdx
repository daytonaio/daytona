---
title: "ファイルシステム"
hideTitleOnPage: true
---

## FileSystem \{#filesystem\}

サンドボックス内のファイルシステム操作を提供します。

### コンストラクタ \{#constructors\}

#### new FileSystem() \{#new-filesystem\}

```ts
new FileSystem(
   sandboxId: string, 
   clientConfig: Configuration, 
   toolboxApi: ToolboxApi, 
   getRootDir: () => Promise<string>): FileSystem
```

**パラメータ**:

* `sandboxId` *string*
* `clientConfig` *Configuration*
* `toolboxApi` *ToolboxApi*
* `getRootDir` *() =&gt; Promise&lt;string&gt;*

**戻り値**:

* `FileSystem`

### メソッド \{#methods\}

#### createFolder() \{#createfolder\}

```ts
createFolder(path: string, mode: string): Promise<void>
```

指定したパーミッションでサンドボックス内に新規ディレクトリを作成します。

**パラメーター**:

* `path` *string* - ディレクトリを作成するパス。相対パスはユーザーのルートディレクトリを基準に解決されます。
* `mode` *string* - 8進数表記のディレクトリのパーミッション（例: &quot;755&quot;）

**戻り値**:

* `Promise<void>`

**例:**

```ts
// 一般的なパーミッションでディレクトリを作成
await fs.createFolder('app/data', '755');
```

***

#### deleteFile() \{#deletefile\}

```ts
deleteFile(path: string, recursive?: boolean): Promise<void>
```

サンドボックスからファイルまたはディレクトリを削除します。

**Parameters**:

* `path` *string* - 削除するファイルまたはディレクトリへのパス。相対パスはユーザーのルートディレクトリを基準に解決されます。
* `recursive?` *boolean* - 対象がディレクトリの場合、削除するには true にする必要があります。

**Returns**:

* `Promise<void>`

**Example:**

```ts
// ファイルを削除
await fs.deleteFile('app/temp.log');
```

***

#### downloadFile() \{#downloadfile\}

##### 呼び出しシグネチャ \{#call-signature\}

```ts
downloadFile(remotePath: string, timeout?: number): Promise<Buffer<ArrayBufferLike>>
```

サンドボックスからファイルをダウンロードします。このメソッドはファイル全体をメモリに読み込むため、大きなファイルのダウンロードには推奨されません。

**パラメータ**:

* `remotePath` *string* - ダウンロードするファイルのパス。相対パスはユーザーのルートディレクトリを基準に解決されます。
* `timeout?` *number* - ダウンロード処理のタイムアウト（秒）。0 はタイムアウトなしを意味します。既定値は 30 分です。

**戻り値**:

* `Promise<Buffer<ArrayBufferLike>>` - ファイル内容を表す Buffer。

**例:**

```ts
// ファイルをダウンロードして処理する
const fileBuffer = await fs.downloadFile('tmp/data.json');
console.log('File content:', fileBuffer.toString());
```

##### 呼び出しシグネチャ \{#call-signature\}

```ts
downloadFile(
   remotePath: string, 
   localPath: string, 
timeout?: number): Promise<void>
```

サンドボックスからファイルをダウンロードしてローカルに保存します。このメソッドはストリーミングでダウンロードを行うため、大きなファイルの取得に推奨されます。

**パラメーター**:

* `remotePath` *string* - サンドボックス内でダウンロードするファイルのパス。相対パスはユーザーのルートディレクトリを基準に解決されます。
* `localPath` *string* - ダウンロードしたファイルの保存先パス。
* `timeout?` *number* - ダウンロード処理のタイムアウト（秒）。0 はタイムアウトなしを意味します。既定は 30 分です。

**戻り値**:

* `Promise<void>`

**例:**

```ts
// ファイルをダウンロードして保存する
await fs.downloadFile('tmp/data.json', 'local_file.json');
```

***

#### findFiles() \{#findfiles\}

```ts
findFiles(path: string, pattern: string): Promise<Match[]>
```

サンドボックス内のファイルからテキストパターンを検索します。

**パラメーター**:

* `path` *string* - 検索対象のディレクトリ。相対パスはユーザーの
  ルートディレクトリを基準に解決されます。
* `pattern` *string* - 検索パターン

**戻り値**:

* `Promise<Match[]>` - ファイル名と行情報を含む一致結果の配列

**例:**

```ts
// TypeScript ファイル内のすべての TODO コメントを検索
const matches = await fs.findFiles('app/src', 'TODO:');
matches.forEach(match => {
  console.log(`${match.file}:${match.line}: ${match.content}`);
});
```

***

#### getFileDetails() \{#getfiledetails\}

```ts
getFileDetails(path: string): Promise<FileInfo>
```

ファイルまたはディレクトリの詳細情報を取得します。

**パラメーター**:

* `path` *string* - ファイルまたはディレクトリへのパス。相対パスはユーザーの
  ルートディレクトリを基準に解決されます。

**戻り値**:

* `Promise<FileInfo>` - サイズ、パーミッション、更新時刻などの詳細なファイル情報

**例:**

```ts
// ファイルの詳細を取得
const info = await fs.getFileDetails('app/config.json');
console.log(`Size: ${info.size}, Modified: ${info.modTime}`);
```

***

#### listFiles() \{#listfiles\}

```ts
listFiles(path: string): Promise<FileInfo[]>
```

サンドボックス内のディレクトリの内容を一覧します。

**パラメーター**:

* `path` *string* - 一覧するディレクトリのパス。相対パスはユーザーのルートディレクトリを基準に解決されます。

**戻り値**:

* `Promise<FileInfo[]>` - ファイルおよびディレクトリの情報を表す配列

**例:**

```ts
// ディレクトリの内容を一覧
const files = await fs.listFiles('app/src');
files.forEach(file => {
  console.log(`${file.name} (${file.size} bytes)`);
});
```

***

#### moveFiles() \{#movefiles\}

```ts
moveFiles(source: string, destination: string): Promise<void>
```

ファイルまたはディレクトリを移動または名前変更します。

**パラメーター**:

* `source` *string* - 参照元パス。相対パスはユーザーのルートディレクトリを基準に解決されます。
* `destination` *string* - 移動先パス。相対パスはユーザーのルートディレクトリを基準に解決されます。

**戻り値**:

* `Promise<void>`

**例:**

```ts
// ファイルを新しい場所に移動する
await fs.moveFiles('app/temp/data.json', 'app/data/data.json');
```

***

#### replaceInFiles() \{#replaceinfiles\}

```ts
replaceInFiles(
   files: string[], 
   pattern: string, 
newValue: string): Promise<ReplaceResult[]>
```

複数のファイルに含まれるテキストを一括置換します。

**パラメータ**:

* `files` *string[]* - 処理対象のファイルパス配列。相対パスはユーザーの作業ディレクトリを基準に解決されます
* `pattern` *string* - 置換対象のパターン
* `newValue` *string* - 置換後の文字列

**戻り値**:

* `Promise<ReplaceResult[]>` - 各ファイルに対する置換結果

**例:**

```ts
// 複数ファイルにわたってバージョン番号を更新
const results = await fs.replaceInFiles(
  ['app/package.json', 'app/version.ts'],
  '"version": "1.0.0"',
  '"version": "1.1.0"'
);
```

***

#### searchFiles() \{#searchfiles\}

```ts
searchFiles(path: string, pattern: string): Promise<SearchFilesResponse>
```

サンドボックス内で、名前パターンに一致するファイルやディレクトリを検索します。

**パラメーター**:

* `path` *string* - 検索対象のディレクトリ。相対パスはユーザーの作業ディレクトリを基準に解決されます
* `pattern` *string* - ファイル名パターン（glob をサポート）

**戻り値**:

* `Promise<SearchFilesResponse>` - 一致したファイルを含む検索結果

**例:**

```ts
// すべての TypeScript ファイルを検索
const result = await fs.searchFiles('app', '*.ts');
result.files.forEach(file => console.log(file));
```

***

#### setFilePermissions() \{#setfilepermissions\}

```ts
setFilePermissions(path: string, permissions: FilePermissionsParams): Promise<void>
```

ファイルまたはディレクトリの権限（パーミッション）と所有権を設定します。

**パラメーター**:

* `path` *string* - ファイルまたはディレクトリへのパス。相対パスはユーザーの
  ルートディレクトリを基準に解決されます。
* `permissions` *FilePermissionsParams* - 権限設定

**戻り値**:

* `Promise<void>`

**例:**

```ts
// ファイルの権限（パーミッション）と所有権を設定
await fs.setFilePermissions('app/script.sh', {
  owner: 'daytona',
  group: 'users',
  mode: '755'  // シェルスクリプトの実行権限
});
```

***

#### uploadFile() \{#uploadfile\}

##### 呼び出しシグネチャ \{#call-signature\}

```ts
uploadFile(
   file: Buffer, 
   remotePath: string, 
timeout?: number): Promise<void>
```

サンドボックスにファイルをアップロードします。このメソッドはファイル全体をメモリに読み込むため、大きなファイルのアップロードには適していません。

**パラメーター**:

* `file` *Buffer* - アップロードするファイルのバッファ。
* `remotePath` *string* - サンドボックス内の保存先パス。相対パスはユーザーの
  ルートディレクトリを基準に解決されます。
* `timeout?` *number* - アップロード処理のタイムアウト（秒）。0 はタイムアウトなしを意味します。
  既定値は30分です。

**戻り値**:

* `Promise<void>`

**例:**

```ts
// 設定ファイルをアップロード
await fs.uploadFile(Buffer.from('{"setting": "value"}'), 'tmp/config.json');
```

##### 呼び出しシグネチャ \{#call-signature\}

```ts
uploadFile(
   localPath: string, 
   remotePath: string, 
timeout?: number): Promise<void>
```

ローカルファイルシステムからサンドボックスへファイルをアップロードします。このメソッドはストリーミングでアップロードを行うため、大きなファイルのアップロードに適しています。

**パラメーター**:

* `localPath` *string* - アップロードするローカルファイルのパス。
* `remotePath` *string* - サンドボックス内のアップロード先パス。相対パスはユーザーの
  ルートディレクトリを基準に解決されます。
* `timeout?` *number* - アップロード処理のタイムアウト（秒）。0 はタイムアウトなしを意味します。
  既定値は30分です。

**戻り値**:

* `Promise<void>`

**例:**

```ts
// ローカルファイルをアップロード
await fs.uploadFile('local_file.txt', 'tmp/file.txt');
```

***

#### uploadFiles() \{#uploadfiles\}

```ts
uploadFiles(files: FileUpload[], timeout?: number): Promise<void>
```

複数のファイルをサンドボックスにアップロードします。宛先パスに既にファイルが存在する場合は上書きされます。

**パラメーター**:

* `files` *FileUpload[]* - アップロードするファイルの配列。
* `timeout?` *number = ...* - アップロードのタイムアウト（秒）。0 はタイムアウトなしを意味します。
  既定値は 30 分です。

**戻り値**:

* `Promise<void>`

**例:**

```ts
// 複数のテキストファイルをアップロード
const files = [
  {
    source: Buffer.from('Content of file 1'),
    destination: '/tmp/file1.txt'
  },
  {
    source: 'app/data/file2.txt',
    destination: '/tmp/file2.txt'
  },
  {
    source: Buffer.from('{"key": "value"}'),
    destination: '/tmp/config.json'
  }
];
await fs.uploadFiles(files);
```

***

## FilePermissionsParams \{#filepermissionsparams\}

サンドボックス内のファイル権限を設定するためのパラメータ。

**プロパティ**:

* `group?` *string* - ファイルのグループ所有者
* `mode?` *string* - 8進数形式のファイルモード/パーミッション（例: &quot;644&quot;）
* `owner?` *string* - ファイルのユーザー所有者

**例:**

```ts
const permissions: FilePermissionsParams = {
  mode: '644',
  owner: 'daytona',
  group: 'users'
};
```

## FileUpload \{#fileupload\}

サンドボックスにアップロードするファイルを表します。

**プロパティ**:

* `destination` *string* - サンドボックス内の絶対パス。相対パスはユーザーの
  ルートディレクトリを基準に解決されます。
* `source` *string | Buffer&lt;ArrayBufferLike&gt;* - アップロードするファイル。Buffer の場合はファイル内容として解釈され、メモリに読み込まれます。
  メモリに収まることを確認してください。収まらない場合はローカルのファイルパスを使用してください。内容はサンドボックスへストリーミングされます。