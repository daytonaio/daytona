{
  "name": "sdk-go",
  "$schema": "../../node_modules/nx/schemas/project-schema.json",
  "projectType": "library",
  "sourceRoot": "libs/sdk-go",
  "targets": {
    "build": {
      "executor": "nx:run-commands",
      "inputs": ["goProduction", "^goProduction"],
      "outputs": [],
      "options": {
        "cwd": "{projectRoot}",
        "commands": ["go mod download", "go build -v ./..."],
        "parallel": false
      }
    },
    "test": {
      "executor": "nx:run-commands",
      "options": {
        "cwd": "{projectRoot}",
        "command": "go test -v -race ./..."
      },
      "dependsOn": ["build"]
    },
    "test:coverage": {
      "executor": "nx:run-commands",
      "options": {
        "cwd": "{projectRoot}",
        "commands": [
          "go test -v -race -coverprofile=coverage.out ./...",
          "go tool cover -html=coverage.out -o coverage.html"
        ],
        "parallel": false
      },
      "dependsOn": ["build"]
    },
    "test:short": {
      "executor": "nx:run-commands",
      "options": {
        "cwd": "{projectRoot}",
        "command": "go test -v -short ./..."
      }
    },
    "lint": {
      "executor": "nx:run-commands",
      "options": {
        "cwd": "{projectRoot}",
        "command": "golangci-lint run ./..."
      }
    },
    "fmt": {
      "executor": "nx:run-commands",
      "cache": true,
      "inputs": ["default"],
      "outputs": [],
      "options": {
        "cwd": "{projectRoot}",
        "command": "go fmt ./..."
      }
    },
    "tidy": {
      "executor": "nx:run-commands",
      "options": {
        "cwd": "{projectRoot}",
        "command": "go mod tidy"
      }
    },
    "clean": {
      "executor": "nx:run-commands",
      "options": {
        "cwd": "{projectRoot}",
        "commands": ["go clean", "rm -rf coverage.out coverage.html", "rm -rf dist"],
        "parallel": false
      }
    },
    "docs": {
      "executor": "nx:run-commands",
      "cache": true,
      "outputs": [
        "{workspaceRoot}/apps/docs/src/content/docs/en/go-sdk/**/*"
      ],
      "options": {
        "cwd": "{projectRoot}",
        "commands": [
          "gomarkdoc --template-file file=templates/file.gotxt --template-file example=templates/example.gotxt --template-file func=templates/func.gotxt --template-file type=templates/type.gotxt -o ../../apps/docs/src/content/docs/en/go-sdk/daytona.mdx ./pkg/daytona",
          "gomarkdoc --template-file file=templates/file.gotxt --template-file example=templates/example.gotxt --template-file func=templates/func.gotxt --template-file type=templates/type.gotxt -o ../../apps/docs/src/content/docs/en/go-sdk/types.mdx ./pkg/types",
          "gomarkdoc --template-file file=templates/file.gotxt --template-file example=templates/example.gotxt --template-file func=templates/func.gotxt --template-file type=templates/type.gotxt -o ../../apps/docs/src/content/docs/en/go-sdk/errors.mdx ./pkg/errors",
          "gomarkdoc --template-file file=templates/file.gotxt --template-file example=templates/example.gotxt --template-file func=templates/func.gotxt --template-file type=templates/type.gotxt -o ../../apps/docs/src/content/docs/en/go-sdk/options.mdx ./pkg/options"
        ],
        "parallel": false
      }
    },
    "generate": {
      "executor": "nx:run-commands",
      "cache": true,
      "inputs": ["{projectRoot}/**/*.go"],
      "outputs": [],
      "options": {
        "cwd": "{projectRoot}",
        "command": "go generate ./..."
      }
    },
    "set-version": {
      "executor": "nx:run-commands",
      "cache": true,
      "inputs": [{ "env": "VERSION" }],
      "outputs": ["{projectRoot}/pkg/daytona/VERSION"],
      "options": {
        "cwd": "{projectRoot}",
        "commands": ["echo \"${VERSION:-v0.0.0-dev}\" > pkg/daytona/VERSION"],
        "parallel": false
      }
    },
    "check-version-env": {},
    "prepare-release": {
      "executor": "nx:run-commands",
      "options": {
        "cwd": "{projectRoot}",
        "commands": [
          "git add pkg/daytona/VERSION",
          "git add go.mod ../../apps/cli/go.mod",
          "git commit -s -m \"chore(sdk-go): bump to ${VERSION:-v0.0.0-dev}\" || true"
        ],
        "parallel": false
      },
      "dependsOn": [
        "check-version-env",
        "set-version",
        {
          "target": "set-version",
          "projects": ["api-client-go", "toolbox-api-client-go"]
        }
      ]
    }
  }
}
